(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[672],{90983:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/forms/[formId]",function(){return c(9287)}])},73149:function(c,b,a){"use strict";var d=a(85893),e=a(68527),f=a(7983);b.Z=function(){return(0,d.jsxs)(e.Kq,{children:[(0,d.jsx)(f.Od,{height:"20px"}),(0,d.jsx)(f.Od,{height:"20px"}),(0,d.jsx)(f.Od,{height:"20px"})]})}},33340:function(d,c,a){"use strict";a.d(c,{CG:function(){return g},TL:function(){return f},tK:function(){return h}});var e=a(69795),b=a(9473),f=b.I0,g=b.v9,h=function(){var a=(0,e.Ge)().library;return function(b,c){return new Promise(function(d,e){a.currentProvider.send({method:"eth_signTypedData_v4",params:[b,c],from:b},function(a,b){a?e(a):d(b.result)})})}}},9287:function(i,b,a){"use strict";a.r(b),a.d(b,{default:function(){return F}});var e,j,c=a(47568),f=a(34051),d=a.n(f),k=a(85893),l=a(67294),m=a(68527),n=a(79762),o=a(4612),p=a(11391),q=a(15193),r=a(73149),s=a(33340),t=a(55218),u=a(26135),v=a(11163),w=a(68288),x=a(69795),y=a(3461),g=a(9669),z=a.n(g),A=a(52325),B=(e=(0,c.Z)(d().mark(function a(b){var c;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,A.groth16.fullProve(b,"prove/prove.wasm","prove/prove_1.zkey");case 2:return c=a.sent,a.abrupt("return",c);case 4:case"end":return a.stop()}},a)})),function(a){return e.apply(this,arguments)});(0,c.Z)(d().mark(function a(b){var c,e,f;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,z().get("http://localhost:3000/prove/verification_key.json");case 2:return e=(c=a.sent).data,a.next=6,A.groth16.verify(e,b.publicSignals,b.proof);case 6:return f=a.sent,a.abrupt("return",f);case 8:case"end":return a.stop()}},a)}));var C=a(65018),D=a(58170),h=a(18661),E=h.generateProof,F=function(){var a,i=(0,v.useRouter)().query,I=(0,s.tK)(),J=(0,x.Ge)().account,b=(0,l.useState)(!1),K=(b[0],b[1]),j=(0,s.TL)(),z=(0,s.CG)(function(a){return a.form.gettingForm}),A=(0,s.CG)(function(a){return a.formAnswers.submissionComplete}),e=(0,s.CG)(function(a){return a.form.form}),f=(0,l.useState)([]),L=f[0],M=f[1],g=e.questions,h=null===(a=i.formId)|| void 0===a?void 0:a.toString();if((0,l.useEffect)(function(){h&&j((0,u.R)({formId:h}))},[j,h]),z)return(0,k.jsx)(r.Z,{});var N=g.map(function(a,b){var c=a.required;return{questionIndex:b,empty:!L.find(function(c,a){return a===b})&&c}}).filter(function(a){return a.empty});if(A)return(0,k.jsx)(m.xu,{children:(0,k.jsx)(m.xv,{children:"Thank you for answering our questions. Your answers:"})});if(!h)return(0,k.jsx)(k.Fragment,{});var F,G,H=(F=(0,c.Z)(d().mark(function a(){var b,c,e,f,g,i,k,l,m,n,o,p;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(N){a.next=4;break}K(!0),a.next=25;break;case 4:if(!J){a.next=25;break}return b={domain:w.dL,types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Submission:[{name:"message",type:"string"}]},primaryType:"Submission",message:{message:"Keep the signature safe! - StoryForm"}},a.next=8,I(J,JSON.stringify(b));case 8:return c=a.sent,e=new C.i(c),f=BigInt(0),g="signal membership",i=[e.generateCommitment()],(k=new D.Z).addMembers(i.map(function(a){return a})),a.next=17,E(e,k,f,g);case 17:return l=a.sent,m=BigInt(c),n=BigInt("0x".concat(h)),o=(0,y.poseidon)([m,n]),a.next=23,B({secret:m,formId:n,submissionId:o});case 23:p=a.sent,j((0,t.k)({formId:h,submissionId:o.toString(),membershipProof:JSON.stringify(l),dataSubmissionProof:JSON.stringify(p,null,0),answers:L}));case 25:case"end":return a.stop()}},a)})),function(){return F.apply(this,arguments)}),O=(G=(0,c.Z)(d().mark(function a(b,c){return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:M(L.map(function(a,d){return d===c?b:a}));case 1:case"end":return a.stop()}},a)})),function(a,b){return G.apply(this,arguments)});return(0,k.jsx)(m.M5,{width:"100%",display:"flex",flexDirection:"column",bgColor:"#f2ddc1",p:3,children:(0,k.jsxs)(m.W2,{maxW:640,children:[(0,k.jsx)(m.X6,{size:"md",mb:3,children:e.title}),(0,k.jsx)(n.NI,{children:g.map(function(a,b){var c;return(0,k.jsxs)(m.xu,{padding:"24px",borderWidth:1,borderRadius:10,mb:3,bgColor:"white",borderColor:"lightgrey",children:[(0,k.jsxs)(n.lX,{mb:4,children:[a.label,a.required?" *":""]}),"text"===a.type?(0,k.jsx)(o.II,{borderWidth:"0px 0px 1px 0px",borderRadius:0,padding:"0px 0px 8px",variant:"unstyled",value:L[b],onChange:function(a){O(a.target.value,b)},required:a.required,placeholder:"Enter here"}):"select"===a.type?(0,k.jsx)(p.Ph,{placeholder:a.label,size:"lg",variant:"outline",defaultValue:a.options[0],value:L[b],onChange:function(a){O(a.target.value,b)},children:null===(c=a.options)|| void 0===c?void 0:c.map(function(a){return(0,k.jsx)("option",{value:a,children:a},a)})}):(0,k.jsx)(k.Fragment,{})]},b)})}),(0,k.jsx)(q.zx,{mt:4,onClick:H,children:"Sign and submit"})]})})}},60299:function(){},95979:function(){},82825:function(){}},function(a){a.O(0,[322,639,792,808,482,774,888,179],function(){var b;return a(a.s=90983)}),_N_E=a.O()}])