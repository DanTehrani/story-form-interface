(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[894],{13207:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/form",function(){return c(98156)}])},73149:function(c,b,a){"use strict";var d=a(85893),e=a(68527),f=a(7983);b.Z=function(){return(0,d.jsxs)(e.Kq,{children:[(0,d.jsx)(f.Od,{height:"20px"}),(0,d.jsx)(f.Od,{height:"20px"}),(0,d.jsx)(f.Od,{height:"20px"})]})}},33340:function(d,c,a){"use strict";a.d(c,{CG:function(){return g},TL:function(){return f},tK:function(){return h}});var e=a(69795),b=a(9473),f=b.I0,g=b.v9,h=function(){var a=(0,e.Ge)().library;return function(b,c){return new Promise(function(d,e){a.currentProvider.send({method:"eth_signTypedData_v4",params:[b,c],from:b},function(a,b){a?e(a):d(b.result)})})}}},98156:function(h,b,a){"use strict";a.r(b),a.d(b,{default:function(){return C}});var e,i,c=a(47568),f=a(34051),d=a.n(f),j=a(85893),k=a(67294),l=a(68527),m=a(79762),n=a(4612),o=a(11391),p=a(15193),q=a(73149),r=a(33340),s=a(55218),t=a(26135),u=a(11163),v=a(68288),w=a(69795),x=a(3461),y=a(7200),g=a(9669),z=a.n(g),A=a(52325),B=(e=(0,c.Z)(d().mark(function a(b){var c;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,A.groth16.fullProve(b,"prove/prove.wasm","prove/prove_1.zkey");case 2:return c=a.sent,a.abrupt("return",c);case 4:case"end":return a.stop()}},a)})),function(a){return e.apply(this,arguments)});(0,c.Z)(d().mark(function a(b){var c,e,f;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,z().get("http://localhost:3000/prove/verification_key.json");case 2:return e=(c=a.sent).data,a.next=6,A.groth16.verify(e,b.publicSignals,b.proof);case 6:return f=a.sent,a.abrupt("return",f);case 8:case"end":return a.stop()}},a)}));var C=function(){var a,h=(0,u.useRouter)().query,G=(0,r.tK)(),H=(0,w.Ge)().account,b=(0,k.useState)(!1),I=(b[0],b[1]),i=(0,r.TL)(),z=(0,r.CG)(function(a){return a.form.gettingForm}),A=(0,r.CG)(function(a){return a.formAnswers.submissionComplete}),C=(0,r.CG)(function(a){return a.form.form}),e=(0,k.useState)([]),J=e[0],K=e[1],f=C.questions,g=null===(a=h.f)|| void 0===a?void 0:a.toString();if((0,k.useEffect)(function(){g&&i((0,t.R)({formId:g}))},[i,g]),z)return(0,j.jsx)(q.Z,{});var L=f.map(function(a,b){var c=a.required;return{questionIndex:b,empty:!J.find(function(c,a){return a===b})&&c}}).filter(function(a){return a.empty});if(A)return(0,j.jsx)(l.xu,{children:(0,j.jsx)(l.xv,{children:"Thank you for answering our questions. Your answers:"})});if(!g)return(0,j.jsx)(j.Fragment,{});var D,E,F=(D=(0,c.Z)(d().mark(function a(){var b,c,e,f,h,j,k,l,m;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(L){a.next=4;break}I(!0),a.next=23;break;case 4:if(!H){a.next=23;break}return b={domain:v.dL,types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Submission:[{name:"message",type:"string"}]},primaryType:"Submission",message:{message:"Keep the signature safe! - StoryForm"}},a.t0=x.poseidon,a.next=9,G(H,JSON.stringify(b));case 9:return a.t1=a.sent,a.t2=[a.t1],e=BigInt(c=(0,a.t0)(a.t2)),f=BigInt("0x".concat(g)),h=(0,x.poseidon)([e]),j=(0,x.poseidon)([e,f]),k=new y.a(x.poseidon,3,BigInt(0),2),k.insert(h),l=k.createProof(0),a.next=21,B({secret:e,formId:f,submissionId:j,treePathIndices:l.pathIndices,treeSiblings:l.siblings.map(function(a){return a[0]}),merkleRoot:BigInt(k.root)});case 21:m=a.sent,i((0,s.k)({formId:g,submissionId:j.toString(),proof:JSON.stringify(m,null,0),answers:J}));case 23:case"end":return a.stop()}},a)})),function(){return D.apply(this,arguments)}),M=(E=(0,c.Z)(d().mark(function a(b,c){return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:K(J.map(function(a,d){return d===c?b:a}));case 1:case"end":return a.stop()}},a)})),function(a,b){return E.apply(this,arguments)});return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(l.xu,{width:"100%",height:"50vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:(0,j.jsxs)(l.xu,{width:"60%",children:[(0,j.jsx)(m.NI,{children:f.map(function(a,b){var c;return(0,j.jsxs)(l.xu,{padding:4,children:[(0,j.jsxs)(m.lX,{children:[a.label,a.required?" *":""]}),"text"===a.type?(0,j.jsx)(n.II,{borderWidth:"0px 0px 2px 0px",borderRadius:0,padding:"0px 0px 8px",variant:"unstyled",value:J[b],onChange:function(a){M(a.target.value,b)},required:a.required}):"select"===a.type?(0,j.jsx)(o.Ph,{placeholder:a.label,size:"lg",variant:"outline",defaultValue:a.options[0],value:J[b],onChange:function(a){M(a.target.value,b)},children:null===(c=a.options)|| void 0===c?void 0:c.map(function(a){return(0,j.jsx)("option",{value:a,children:a},a)})}):(0,j.jsx)(j.Fragment,{})]},b)})}),(0,j.jsx)(p.zx,{mt:4,onClick:F,children:"Sign and submit"})]})})})}},60299:function(){},95979:function(){},82825:function(){}},function(a){a.O(0,[322,639,792,808,647,774,888,179],function(){var b;return a(a.s=13207)}),_N_E=a.O()}])