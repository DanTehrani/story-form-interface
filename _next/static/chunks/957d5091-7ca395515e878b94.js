"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[808],{80496:function(__unused_webpack_module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0});var str,bigInt=__webpack_require__(24736),wasmcurves=(__webpack_require__(42474),__webpack_require__(47571)),os=__webpack_require__(73461),Worker=__webpack_require__(84763),wasmbuilder=__webpack_require__(14659);function _interopDefaultLegacy(a){return a&&"object"==typeof a&&"default"in a?a:{default:a}}var bigInt__default=_interopDefaultLegacy(bigInt),os__default=_interopDefaultLegacy(os),Worker__default=_interopDefaultLegacy(Worker);let hexLen=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function fromString$2(a,b){return b&&10!=b?16==b?"0x"==a.slice(0,2)?BigInt(a):BigInt("0x"+a):void 0:BigInt(a)}function isZero$2(a){return!a}function shiftLeft$2(a,b){return BigInt(a)<<BigInt(b)}function shiftRight$2(a,b){return BigInt(a)>>BigInt(b)}var Scalar_native=Object.freeze({__proto__:null,fromString:fromString$2,e:fromString$2,fromArray:function(d,a){let b=BigInt(0);a=BigInt(a);for(let c=0;c<d.length;c++)b=b*a+BigInt(d[c]);return b},bitLength:function(b){let a=b.toString(16);return(a.length-1)*4+hexLen[parseInt(a[0],16)]},isNegative:function(a){return BigInt(a)<BigInt(0)},isZero:isZero$2,shiftLeft:shiftLeft$2,shiftRight:shiftRight$2,shl:shiftLeft$2,shr:shiftRight$2,isOdd:function(a){return(BigInt(a)&BigInt(1))==BigInt(1)},naf:function(d){let a=BigInt(d),b=[];for(;a;){if(a&BigInt(1)){let c=2-Number(a%BigInt(4));b.push(c),a-=BigInt(c)}else b.push(0);a>>=BigInt(1)}return b},bits:function(c){let a=BigInt(c),b=[];for(;a;)a&BigInt(1)?b.push(1):b.push(0),a>>=BigInt(1);return b},toNumber:function(a){if(a>BigInt(Number.MAX_SAFE_INTEGER))throw Error("Number too big");return Number(a)},toArray:function(d,a){let c=[],b=BigInt(d);for(a=BigInt(a);b;)c.unshift(Number(b%a)),b/=a;return c},add:function(a,b){return BigInt(a)+BigInt(b)},sub:function(a,b){return BigInt(a)-BigInt(b)},neg:function(a){return-BigInt(a)},mul:function(a,b){return BigInt(a)*BigInt(b)},square:function(a){return BigInt(a)*BigInt(a)},pow:function(a,b){return BigInt(a)**BigInt(b)},exp:function(a,b){return BigInt(a)**BigInt(b)},abs:function(a){return BigInt(a)>=0?BigInt(a):-BigInt(a)},div:function(a,b){return BigInt(a)/BigInt(b)},mod:function(a,b){return BigInt(a)%BigInt(b)},eq:function(a,b){return BigInt(a)==BigInt(b)},neq:function(a,b){return BigInt(a)!=BigInt(b)},lt:function(a,b){return BigInt(a)<BigInt(b)},gt:function(a,b){return BigInt(a)>BigInt(b)},leq:function(a,b){return BigInt(a)<=BigInt(b)},geq:function(a,b){return BigInt(a)>=BigInt(b)},band:function(a,b){return BigInt(a)&BigInt(b)},bor:function(a,b){return BigInt(a)|BigInt(b)},bxor:function(a,b){return BigInt(a)^BigInt(b)},land:function(a,b){return BigInt(a)&&BigInt(b)},lor:function(a,b){return BigInt(a)||BigInt(b)},lnot:function(a){return!BigInt(a)}});function fromString$1(a,b){return"string"!=typeof a?bigInt__default.default(a,b):"0x"==a.slice(0,2)?bigInt__default.default(a.slice(2),16):bigInt__default.default(a,b)}function shiftLeft$1(a,b){return bigInt__default.default(a).shiftLeft(b)}function shiftRight$1(a,b){return bigInt__default.default(a).shiftRight(b)}var Scalar_bigint=Object.freeze({__proto__:null,fromString:fromString$1,e:fromString$1,fromArray:function(a,b){return bigInt__default.default.fromArray(a,b)},bitLength:function(a){return bigInt__default.default(a).bitLength()},isNegative:function(a){return bigInt__default.default(a).isNegative()},isZero:function(a){return bigInt__default.default(a).isZero()},shiftLeft:shiftLeft$1,shiftRight:shiftRight$1,shl:shiftLeft$1,shr:shiftRight$1,isOdd:function(a){return bigInt__default.default(a).isOdd()},naf:function(d){let a=bigInt__default.default(d),b=[];for(;a.gt(bigInt__default.default.zero);){if(a.isOdd()){let c=2-a.mod(4).toJSNumber();b.push(c),a=a.minus(c)}else b.push(0);a=a.shiftRight(1)}return b},bits:function(c){let a=bigInt__default.default(c),b=[];for(;a.gt(bigInt__default.default.zero);)a.isOdd()?b.push(1):b.push(0),a=a.shiftRight(1);return b},toNumber:function(a){if(!a.lt(bigInt__default.default("9007199254740992",10)))throw Error("Number too big");return a.toJSNumber()},toArray:function(a,b){return bigInt__default.default(a).toArray(b)},add:function(a,b){return bigInt__default.default(a).add(bigInt__default.default(b))},sub:function(a,b){return bigInt__default.default(a).minus(bigInt__default.default(b))},neg:function(a){return bigInt__default.default.zero.minus(bigInt__default.default(a))},mul:function(a,b){return bigInt__default.default(a).times(bigInt__default.default(b))},square:function(a){return bigInt__default.default(a).square()},pow:function(a,b){return bigInt__default.default(a).pow(bigInt__default.default(b))},exp:function(a,b){return bigInt__default.default(a).pow(bigInt__default.default(b))},abs:function(a){return bigInt__default.default(a).abs()},div:function(a,b){return bigInt__default.default(a).divide(bigInt__default.default(b))},mod:function(a,b){return bigInt__default.default(a).mod(bigInt__default.default(b))},eq:function(a,b){return bigInt__default.default(a).eq(bigInt__default.default(b))},neq:function(a,b){return bigInt__default.default(a).neq(bigInt__default.default(b))},lt:function(a,b){return bigInt__default.default(a).lt(bigInt__default.default(b))},gt:function(a,b){return bigInt__default.default(a).gt(bigInt__default.default(b))},leq:function(a,b){return bigInt__default.default(a).leq(bigInt__default.default(b))},geq:function(a,b){return bigInt__default.default(a).geq(bigInt__default.default(b))},band:function(a,b){return bigInt__default.default(a).and(bigInt__default.default(b))},bor:function(a,b){return bigInt__default.default(a).or(bigInt__default.default(b))},bxor:function(a,b){return bigInt__default.default(a).xor(bigInt__default.default(b))},land:function(a,b){return!bigInt__default.default(a).isZero()&&!bigInt__default.default(b).isZero()},lor:function(a,b){return!bigInt__default.default(a).isZero()||!bigInt__default.default(b).isZero()},lnot:function(a){return bigInt__default.default(a).isZero()}});let supportsNativeBigInt$2="function"==typeof BigInt,Scalar$1={};supportsNativeBigInt$2?Object.assign(Scalar$1,Scalar_native):Object.assign(Scalar$1,Scalar_bigint),Scalar$1.toRprLE=function(f,j,g,h){let b="0000000"+g.toString(16),c=new Uint32Array(f.buffer,j,h/4),i=((b.length-7)*4-1>>5)+1;for(let a=0;a<i;a++)c[a]=parseInt(b.substring(b.length-8*a-8,b.length-8*a),16);for(let e=i;e<c.length;e++)c[e]=0;for(let d=4*c.length;d<h;d++)f[d]=Scalar$1.toNumber(Scalar$1.band(Scalar$1.shiftRight(g,8*d),255))},Scalar$1.toRprBE=function(e,h,i,c){let b="0000000"+i.toString(16),f=new DataView(e.buffer,e.byteOffset+h,c),g=((b.length-7)*4-1>>5)+1;for(let a=0;a<g;a++)f.setUint32(c-4*a-4,parseInt(b.substring(b.length-8*a-8,b.length-8*a),16),!1);for(let d=0;d<c/4-g;d++)f[d]=0},Scalar$1.fromRprLE=function(c,b,a){a=a||c.byteLength,b=b||0;let d=new Uint32Array(c.buffer,b,a/4),e=Array(a/4);return d.forEach((a,b)=>e[e.length-b-1]=a.toString(16).padStart(8,"0")),Scalar$1.fromString(e.join(""),16)},Scalar$1.fromRprBE=function(c,d,a){a=a||c.byteLength,d=d||0;let f=new DataView(c.buffer,c.byteOffset+d,a),e=Array(a/4);for(let b=0;b<a/4;b++)e[b]=f.getUint32(4*b,!1).toString(16).padStart(8,"0");return Scalar$1.fromString(e.join(""),16)},Scalar$1.toString=function(a,b){return a.toString(b)},Scalar$1.toLEBuff=function(b){let a=new Uint8Array(Math.floor((Scalar$1.bitLength(b)-1)/8)+1);return Scalar$1.toRprLE(a,0,b,a.byteLength),a},Scalar$1.zero=Scalar$1.e(0),Scalar$1.one=Scalar$1.e(1);let{toRprLE,toRprBE,fromRprLE,fromRprBE,toString,toLEBuff,zero,one,fromString,e,fromArray,bitLength,isNegative,isZero,shiftLeft,shiftRight,shl,shr,isOdd,naf,bits,toNumber,toArray,add,sub,neg,mul,square,pow,exp:exp$1,abs,div,mod,eq,neq,lt,gt,leq,geq,band,bor,bxor,land,lor,lnot}=Scalar$1;var _Scalar=Object.freeze({__proto__:null,toRprLE:toRprLE,toRprBE:toRprBE,fromRprLE:fromRprLE,fromRprBE:fromRprBE,toString:toString,toLEBuff:toLEBuff,zero:zero,one:one,fromString:fromString,e:e,fromArray:fromArray,bitLength:bitLength,isNegative:isNegative,isZero:isZero,shiftLeft:shiftLeft,shiftRight:shiftRight,shl:shl,shr:shr,isOdd:isOdd,naf:naf,bits:bits,toNumber:toNumber,toArray:toArray,add:add,sub:sub,neg:neg,mul:mul,square:square,pow:pow,exp:exp$1,abs:abs,div:div,mod:mod,eq:eq,neq:neq,lt:lt,gt:gt,leq:leq,geq:geq,band:band,bor:bor,bxor:bxor,land:land,lor:lor,lnot:lnot});function log2$2(a){return((4294901760&a)!=0?(a&=4294901760,16):0)|((4278255360&a)!=0?(a&=4278255360,8):0)|((4042322160&a)!=0?(a&=4042322160,4):0)|((3435973836&a)!=0?(a&=3435973836,2):0)|(2863311530&a)!=0}function __fft$1(a,c,e,d,f){let g=1<<e;if(1==g)return[c[d]];if(2==g)return[a.F.add(c[d],c[d+f]),a.F.sub(c[d],c[d+f])];let i=g>>1,j=__fft$1(a,c,e-1,d,2*f),k=__fft$1(a,c,e-1,d+f,2*f),h=Array(g);for(let b=0;b<i;b++)h[b]=a.F.add(j[b],a.F.mul(a.roots[e][b],k[b])),h[b+i]=a.F.sub(j[b],a.F.mul(a.roots[e][b],k[b]));return h}function __fft2(b,e,c){let f=1<<c;if(1==f)return[e[0]];let d=f>>1,h=__fft2(b,e.slice(0,d),c-1),i=__fft2(b,e.slice(d),c-1),g=Array(f);for(let a=0;a<d;a++)g[a]=b.F.add(h[a],b.F.mul(b.roots[c][a],i[a])),g[a+d]=b.F.sub(h[a],b.F.mul(b.roots[c][a],i[a]));return g}let _revTable$1=[];for(let i=0;i<256;i++)_revTable$1[i]=_revSlow$1(i,8);function _revSlow$1(d,e){let a=0,b=d;for(let c=0;c<e;c++)a<<=1,a|=1&b,b>>=1;return a}function rev(a,b){return(_revTable$1[a>>>24]|_revTable$1[a>>>16&255]<<8|_revTable$1[a>>>8&255]<<16|_revTable$1[255&a]<<24)>>>32-b}function __bitReverse(b,d){for(let a=0;a<b.length;a++){let c=rev(a,d);if(c>a){let e=b[a];b[a]=b[c],b[c]=e}}}function mulScalar(c,d,f){let a;if(isZero(f))return c.zero;let b=naf(f);if(1==b[b.length-1])a=d;else if(-1==b[b.length-1])a=c.neg(d);else throw Error("invlaud NAF");for(let e=b.length-2;e>=0;e--)a=c.double(a),1==b[e]?a=c.add(a,d):-1==b[e]&&(a=c.sub(a,d));return a}function exp(b,e,f){if(isZero(f))return b.one;let c=bits(f);if(0==c.length)return b.one;let a=e;for(let d=c.length-2;d>=0;d--)a=b.square(a),c[d]&&(a=b.mul(a,e));return a}function buildSqrt(a){if(a.m%2==1){if(eq(mod(a.p,4),1)){if(eq(mod(a.p,8),1)){if(eq(mod(a.p,16),1))alg5_tonelliShanks(a);else if(eq(mod(a.p,16),9))alg4_kong(a);else throw Error("Field withot sqrt")}else if(eq(mod(a.p,8),5))alg3_atkin(a);else throw Error("Field withot sqrt")}else eq(mod(a.p,4),3)&&alg2_shanks(a)}else{let b=mod(pow(a.p,a.m/2),4);1==b?alg10_adj(a):3==b?alg9_adj(a):alg8_complex(a)}}function alg5_tonelliShanks(a){for(a.sqrt_q=pow(a.p,a.m),a.sqrt_s=0,a.sqrt_t=sub(a.sqrt_q,1);!isOdd(a.sqrt_t);)a.sqrt_s=a.sqrt_s+1,a.sqrt_t=div(a.sqrt_t,2);let b=a.one;for(;a.eq(b,a.one);){let c=a.random();a.sqrt_z=a.pow(c,a.sqrt_t),b=a.pow(a.sqrt_z,2**(a.sqrt_s-1))}a.sqrt_tm1d2=div(sub(a.sqrt_t,1),2),a.sqrt=function(d){let a=this;if(a.isZero(d))return a.zero;let b=a.pow(d,a.sqrt_tm1d2),k=a.pow(a.mul(a.square(b),d),2**(a.sqrt_s-1));if(a.eq(k,a.negone))return null;let i=a.sqrt_s,c=a.mul(d,b),e=a.mul(c,b),f=a.sqrt_z;for(;!a.eq(e,a.one);){let g=a.square(e),h=1;for(;!a.eq(g,a.one);)g=a.square(g),h++;b=f;for(let j=0;j<i-h-1;j++)b=a.square(b);f=a.square(b),e=a.mul(e,f),c=a.mul(c,b),i=h}return a.geq(c,a.zero)?c:a.neg(c)}}function alg4_kong(a){a.sqrt=function(){throw Error("Sqrt alg 4 not implemented")}}function alg3_atkin(a){a.sqrt=function(){throw Error("Sqrt alg 3 not implemented")}}function alg2_shanks(a){a.sqrt_q=pow(a.p,a.m),a.sqrt_e1=div(sub(a.sqrt_q,3),4),a.sqrt=function(b){if(this.isZero(b))return this.zero;let d=this.pow(b,this.sqrt_e1),e=this.mul(this.square(d),b);if(this.eq(e,this.negone))return null;let c=this.mul(d,b);return a.geq(c,a.zero)?c:a.neg(c)}}function alg10_adj(a){a.sqrt=function(){throw Error("Sqrt alg 10 not implemented")}}function alg9_adj(a){a.sqrt_q=pow(a.p,a.m/2),a.sqrt_e34=div(sub(a.sqrt_q,3),4),a.sqrt_e12=div(sub(a.sqrt_q,1),2),a.frobenius=function(c,b){return c%2==1?a.conjugate(b):b},a.sqrt=function(c){let d=this.pow(c,this.sqrt_e34),b=this.mul(this.square(d),c),f=this.mul(this.frobenius(1,b),b);if(this.eq(f,this.negone))return null;let e=this.mul(d,c),a;if(this.eq(b,this.negone))a=this.mul(e,[this.F.zero,this.F.one]);else{let g=this.pow(this.add(this.one,b),this.sqrt_e12);a=this.mul(g,e)}return this.geq(a,this.zero)?a:this.neg(a)}}function alg8_complex(a){a.sqrt=function(){throw Error("Sqrt alg 8 not implemented")}}function quarterRound(a,d,b,e,c){a[d]=a[d]+a[b]>>>0,a[c]=(a[c]^a[d])>>>0,a[c]=(a[c]<<16|a[c]>>>16&65535)>>>0,a[e]=a[e]+a[c]>>>0,a[b]=(a[b]^a[e])>>>0,a[b]=(a[b]<<12|a[b]>>>20&4095)>>>0,a[d]=a[d]+a[b]>>>0,a[c]=(a[c]^a[d])>>>0,a[c]=(a[c]<<8|a[c]>>>24&255)>>>0,a[e]=a[e]+a[c]>>>0,a[b]=(a[b]^a[e])>>>0,a[b]=(a[b]<<7|a[b]>>>25&127)>>>0}function doubleRound(a){quarterRound(a,0,4,8,12),quarterRound(a,1,5,9,13),quarterRound(a,2,6,10,14),quarterRound(a,3,7,11,15),quarterRound(a,0,5,10,15),quarterRound(a,1,6,11,12),quarterRound(a,2,7,8,13),quarterRound(a,3,4,9,14)}class ChaCha{constructor(a){a=a||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],0,0,0,0],this.idx=16,this.buff=Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return add(mul(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(1&this.nextU32())==1}update(){for(let b=0;b<16;b++)this.buff[b]=this.state[b];for(let c=0;c<10;c++)doubleRound(this.buff);for(let a=0;a<16;a++)this.buff[a]=this.buff[a]+this.state[a]>>>0;if(this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12])this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0))}}function getRandomBytes(c){let a=new Uint8Array(c);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(a);else for(let b=0;b<c;b++)a[b]=4294967296*Math.random()>>>0;return a}let threadRng=null;function getThreadRng(){return threadRng||(threadRng=new ChaCha(function(){let c=getRandomBytes(32),d=new Uint32Array(c.buffer),b=[];for(let a=0;a<8;a++)b.push(d[a]);return b}()))}class FFT{constructor(e,a,f){this.F=a,this.G=e,this.opMulGF=f;let g=a.sqrt_t||a.t,b=a.sqrt_s||a.s,d=a.one;for(;a.eq(a.pow(d,a.half),a.one);)d=a.add(d,a.one);this.w=Array(b+1),this.wi=Array(b+1),this.w[b]=this.F.pow(d,g),this.wi[b]=this.F.inv(this.w[b]);let c=b-1;for(;c>=0;)this.w[c]=this.F.square(this.w[c+1]),this.wi[c]=this.F.square(this.wi[c+1]),c--;this.roots=[],this._setRoots(Math.min(b,15))}_setRoots(f){for(let a=f;a>=0&&!this.roots[a];a--){let b=this.F.one,d=1<<a,e=Array(d);for(let c=0;c<d;c++)e[c]=b,b=this.F.mul(b,this.w[a]);this.roots[a]=e}}fft(a){if(a.length<=1)return a;let b=log2$1(a.length-1)+1;this._setRoots(b);let c=1<<b;if(a.length!=c)throw Error("Size must be multiple of 2");let d=__fft(this,a,b,0,1);return d}ifft(b){if(b.length<=1)return b;let d=log2$1(b.length-1)+1;this._setRoots(d);let a=1<<d;if(b.length!=a)throw Error("Size must be multiple of 2");let f=__fft(this,b,d,0,1),g=this.F.inv(this.F.mulScalar(this.F.one,a)),e=Array(a);for(let c=0;c<a;c++)e[c]=this.opMulGF(f[(a-c)%a],g);return e}}function log2$1(a){return((4294901760&a)!=0?(a&=4294901760,16):0)|((4278255360&a)!=0?(a&=4278255360,8):0)|((4042322160&a)!=0?(a&=4042322160,4):0)|((3435973836&a)!=0?(a&=3435973836,2):0)|(2863311530&a)!=0}function __fft(a,c,e,d,f){let g=1<<e;if(1==g)return[c[d]];if(2==g)return[a.G.add(c[d],c[d+f]),a.G.sub(c[d],c[d+f])];let i=g>>1,j=__fft(a,c,e-1,d,2*f),k=__fft(a,c,e-1,d+f,2*f),h=Array(g);for(let b=0;b<i;b++)h[b]=a.G.add(j[b],a.opMulGF(k[b],a.roots[e][b])),h[b+i]=a.G.sub(j[b],a.opMulGF(k[b],a.roots[e][b]));return h}var FFFT=Object.freeze({__proto__:null,default:FFT});let supportsNativeBigInt$1="function"==typeof BigInt,_F1Field;_F1Field=supportsNativeBigInt$1?class{constructor(c){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(c),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=bitLength(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);let a=this.negone>>this.one;this.nqr=this.two;let b=this.pow(this.nqr,a);for(;!this.eq(b,this.negone);)this.nqr=this.nqr+this.one,b=this.pow(this.nqr,a);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),buildSqrt(this),this.FFT=new FFT(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(c,d){let a;if(d?16==d&&(a=BigInt("0x"+c)):a=BigInt(c),!(a<0))return a>=this.p?a%this.p:a;{let b=-a;return b>=this.p&&(b%=this.p),this.p-b}}add(b,c){let a=b+c;return a>=this.p?a-this.p:a}sub(a,b){return a>=b?a-b:this.p-b+a}neg(a){return a?this.p-a:a}mul(a,b){return a*b%this.p}mulScalar(a,b){return a*this.e(b)%this.p}square(a){return a*a%this.p}eq(a,b){return a==b}neq(a,b){return a!=b}lt(a,b){let c=a>this.half?a-this.p:a,d=b>this.half?b-this.p:b;return c<d}gt(a,b){let c=a>this.half?a-this.p:a,d=b>this.half?b-this.p:b;return c>d}leq(a,b){let c=a>this.half?a-this.p:a,d=b>this.half?b-this.p:b;return c<=d}geq(a,b){let c=a>this.half?a-this.p:a,d=b>this.half?b-this.p:b;return c>=d}div(a,b){return this.mul(a,this.inv(b))}idiv(b,a){if(!a)throw Error("Division by zero");return b/a}inv(e){if(!e)throw Error("Division by zero");let a=this.zero,c=this.p,d=this.one,b=e%this.p;for(;b;){let f=c/b;[a,d]=[d,a-f*d],[c,b]=[b,c-f*b]}return a<this.zero&&(a+=this.p),a}mod(a,b){return a%b}pow(a,b){return exp(this,a,b)}exp(a,b){return exp(this,a,b)}band(b,c){let a=b&c&this.mask;return a>=this.p?a-this.p:a}bor(b,c){let a=(b|c)&this.mask;return a>=this.p?a-this.p:a}bxor(b,c){let a=(b^c)&this.mask;return a>=this.p?a-this.p:a}bnot(b){let a=b^this.mask;return a>=this.p?a-this.p:a}shl(c,a){if(Number(a)<this.bitLength){let b=c<<a&this.mask;return b>=this.p?b-this.p:b}{let d=this.p-a;return Number(d)<this.bitLength?c>>d:this.zero}}shr(c,a){if(Number(a)<this.bitLength)return c>>a;{let d=this.p-a;if(!(Number(d)<this.bitLength))return 0;{let b=c<<d&this.mask;return b>=this.p?b-this.p:b}}}land(a,b){return a&&b?this.one:this.zero}lor(a,b){return a||b?this.one:this.zero}lnot(a){return a?this.zero:this.one}sqrt_old(b){if(b==this.zero)return this.zero;let j=this.pow(b,this.negone>>this.one);if(j!=this.one)return null;let h=this.s,e=this.nqr_to_t,c=this.pow(b,this.t),a=this.pow(b,this.add(this.t,this.one)>>this.one);for(;c!=this.one;){let f=this.square(c),g=1;for(;f!=this.one;)g++,f=this.square(f);let d=e;for(let i=0;i<h-g-1;i++)d=this.square(d);h=g,e=this.square(d),c=this.mul(c,e),a=this.mul(a,d)}return a>this.p>>this.one&&(a=this.neg(a)),a}normalize(a,c){if(!((a=BigInt(a,c))<0))return a>=this.p?a%this.p:a;{let b=-a;return b>=this.p&&(b%=this.p),this.p-b}}random(){let c=2*this.bitLength/8,a=this.zero;for(let b=0;b<c;b++)a=(a<<BigInt(8))+BigInt(getRandomBytes(1)[0]);return a%this.p}toString(b,a){a=a||10;let c;if(b>this.half&&10==a){let d=this.p-b;c="-"+d.toString(a)}else c=b.toString(a);return c}isZero(a){return a==this.zero}fromRng(c){let a;do{a=this.zero;for(let b=0;b<this.n64;b++)a+=c.nextU64()<<BigInt(64*b);a&=this.mask}while(a>=this.p)return a*this.Ri%this.p}fft(a){return this.FFT.fft(a)}ifft(a){return this.FFT.ifft(a)}}:class{constructor(c){this.type="F1",this.one=bigInt__default.default.one,this.zero=bigInt__default.default.zero,this.p=bigInt__default.default(c),this.m=1,this.negone=this.p.minus(bigInt__default.default.one),this.two=bigInt__default.default(2),this.half=this.p.shiftRight(1),this.bitLength=this.p.bitLength(),this.mask=bigInt__default.default.one.shiftLeft(this.bitLength).minus(bigInt__default.default.one),this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=bigInt__default.default.one.shiftLeft(64*this.n64),this.Ri=this.inv(this.R);let a=this.negone.shiftRight(this.one);this.nqr=this.two;let b=this.pow(this.nqr,a);for(;!b.equals(this.negone);)this.nqr=this.nqr.add(this.one),b=this.pow(this.nqr,a);for(this.s=this.zero,this.t=this.negone;!this.t.isOdd();)this.s=this.s.add(this.one),this.t=this.t.shiftRight(this.one);this.nqr_to_t=this.pow(this.nqr,this.t),buildSqrt(this),this.FFT=new FFFT(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(a,b){let c=bigInt__default.default(a,b);return this.normalize(c)}add(b,c){let a=b.add(c);return a.geq(this.p)&&(a=a.minus(this.p)),a}sub(a,b){return a.geq(b)?a.minus(b):this.p.minus(b.minus(a))}neg(a){return a.isZero()?a:this.p.minus(a)}mul(a,b){return a.times(b).mod(this.p)}mulScalar(a,b){return a.times(bigInt__default.default(b)).mod(this.p)}square(a){return a.square().mod(this.p)}eq(a,b){return a.eq(b)}neq(a,b){return a.neq(b)}lt(a,b){let c=a.gt(this.half)?a.minus(this.p):a,d=b.gt(this.half)?b.minus(this.p):b;return c.lt(d)}gt(a,b){let c=a.gt(this.half)?a.minus(this.p):a,d=b.gt(this.half)?b.minus(this.p):b;return c.gt(d)}leq(a,b){let c=a.gt(this.half)?a.minus(this.p):a,d=b.gt(this.half)?b.minus(this.p):b;return c.leq(d)}geq(a,b){let c=a.gt(this.half)?a.minus(this.p):a,d=b.gt(this.half)?b.minus(this.p):b;return c.geq(d)}div(b,a){if(a.isZero())throw Error("Division by zero");return b.times(a.modInv(this.p)).mod(this.p)}idiv(b,a){if(a.isZero())throw Error("Division by zero");return b.divide(a)}inv(a){if(a.isZero())throw Error("Division by zero");return a.modInv(this.p)}mod(a,b){return a.mod(b)}pow(a,b){return a.modPow(b,this.p)}exp(a,b){return a.modPow(b,this.p)}band(a,b){return a.and(b).and(this.mask).mod(this.p)}bor(a,b){return a.or(b).and(this.mask).mod(this.p)}bxor(a,b){return a.xor(b).and(this.mask).mod(this.p)}bnot(a){return a.xor(this.mask).mod(this.p)}shl(b,a){if(a.lt(this.bitLength))return b.shiftLeft(a).and(this.mask).mod(this.p);{let c=this.p.minus(a);return c.lt(this.bitLength)?this.shr(b,c):bigInt__default.default.zero}}shr(b,a){if(a.lt(this.bitLength))return b.shiftRight(a);{let c=this.p.minus(a);return c.lt(this.bitLength)?this.shl(b,c):bigInt__default.default.zero}}land(a,b){return a.isZero()||b.isZero()?bigInt__default.default.zero:bigInt__default.default.one}lor(a,b){return a.isZero()&&b.isZero()?bigInt__default.default.zero:bigInt__default.default.one}lnot(a){return a.isZero()?bigInt__default.default.one:bigInt__default.default.zero}sqrt_old(b){if(b.equals(this.zero))return this.zero;let j=this.pow(b,this.negone.shiftRight(this.one));if(!j.equals(this.one))return null;let h=parseInt(this.s),e=this.nqr_to_t,c=this.pow(b,this.t),a=this.pow(b,this.add(this.t,this.one).shiftRight(this.one));for(;!c.equals(this.one);){let f=this.square(c),g=1;for(;!f.equals(this.one);)g++,f=this.square(f);let d=e;for(let i=0;i<h-g-1;i++)d=this.square(d);h=g,e=this.square(d),c=this.mul(c,e),a=this.mul(a,d)}return a.greater(this.p.shiftRight(this.one))&&(a=this.neg(a)),a}normalize(a){return(a=bigInt__default.default(a)).isNegative()?this.p.minus(a.abs().mod(this.p)):a.mod(this.p)}random(){let a=bigInt__default.default(0),b=bigInt__default.default(this.p.square());for(;!b.isZero();)a=a.shiftLeft(8).add(bigInt__default.default(getRandomBytes(1)[0])),b=b.shiftRight(8);return a.mod(this.p)}toString(b,a){a=a||10;let c;if(b.lesserOrEquals(this.p.shiftRight(bigInt__default.default(1)))||10!=a)c=b.toString(a);else{let d=this.p.minus(b);c="-"+d.toString(a)}return c}isZero(a){return a.isZero()}fromRng(c){let a;do{a=bigInt__default.default(0);for(let b=0;b<this.n64;b++)a=a.add(a,c.nextU64().shiftLeft(64*b));a=a.and(this.mask)}while(a.geq(this.p))return a.times(this.Ri).mod(this.q)}fft(a){return this.FFT.fft(a)}ifft(a){return this.FFT.ifft(a)}};class F1Field extends _F1Field{toRprLE(a,b,c){toRprLE(a,b,c,8*this.n64)}toRprBE(a,b,c){toRprBE(a,b,c,8*this.n64)}toRprBEM(a,b,c){return this.toRprBE(a,b,this.mul(this.R,c))}toRprLEM(a,b,c){return this.toRprLE(a,b,this.mul(this.R,c))}fromRprLE(a,b){return fromRprLE(a,b,this.n8)}fromRprBE(a,b){return fromRprBE(a,b,this.n8)}fromRprLEM(a,b){return this.mul(this.fromRprLE(a,b),this.Ri)}fromRprBEM(a,b){return this.mul(this.fromRprBE(a,b),this.Ri)}toObject(a){return a}}function isGreatest(c,a){if(Array.isArray(a)){for(let b=a.length-1;b>=0;b--)if(!c.F.isZero(a[b]))return isGreatest(c.F,a[b]);return 0}{let d=c.neg(a);return gt(a,d)}}function stringifyBigInts$2(a){if("bigint"==typeof a|| void 0!==a.eq)return a.toString(10);if(a instanceof Uint8Array)return fromRprLE(a,0);if(Array.isArray(a))return a.map(stringifyBigInts$2);{if("object"!=typeof a)return a;let b={},c=Object.keys(a);return c.forEach(c=>{b[c]=stringifyBigInts$2(a[c])}),b}}function unstringifyBigInts$2(a){if("string"==typeof a&&/^[0-9]+$/.test(a)||"string"==typeof a&&/^0x[0-9a-fA-F]+$/.test(a))return BigInt(a);if(Array.isArray(a))return a.map(unstringifyBigInts$2);{if("object"!=typeof a)return a;if(null===a)return null;let b={},c=Object.keys(a);return c.forEach(c=>{b[c]=unstringifyBigInts$2(a[c])}),b}}function stringifyFElements$1(b,a){if("bigint"==typeof a|| void 0!==a.eq)return a.toString(10);if(a instanceof Uint8Array)return b.toString(b.e(a));if(Array.isArray(a))return a.map(stringifyFElements$1.bind(this,b));{if("object"!=typeof a)return a;let c={},d=Object.keys(a);return d.forEach(d=>{c[d]=stringifyFElements$1(b,a[d])}),c}}function unstringifyFElements$1(b,a){if("string"==typeof a&&/^[0-9]+$/.test(a)||"string"==typeof a&&/^0x[0-9a-fA-F]+$/.test(a))return b.e(a);if(Array.isArray(a))return a.map(unstringifyFElements$1.bind(this,b));{if("object"!=typeof a)return a;if(null===a)return null;let c={},d=Object.keys(a);return d.forEach(d=>{c[d]=unstringifyFElements$1(b,a[d])}),c}}var utils_native=Object.freeze({__proto__:null,stringifyBigInts:stringifyBigInts$2,unstringifyBigInts:unstringifyBigInts$2,beBuff2int:function(c){let d=BigInt(0),a=c.length,b=0,e=new DataView(c.buffer,c.byteOffset,c.byteLength);for(;a>0;)a>=4?(a-=4,d+=BigInt(e.getUint32(a))<<BigInt(8*b),b+=4):a>=2?(a-=2,d+=BigInt(e.getUint16(a))<<BigInt(8*b),b+=2):(a-=1,d+=BigInt(e.getUint8(a))<<BigInt(8*b),b+=1);return d},beInt2Buff:function(f,d){let b=f,e=new Uint8Array(d),c=new DataView(e.buffer),a=d;for(;a>0;)a-4>=0?(a-=4,c.setUint32(a,Number(b&BigInt(4294967295))),b>>=BigInt(32)):a-2>=0?(a-=2,c.setUint16(a,Number(b&BigInt(65535))),b>>=BigInt(16)):(a-=1,c.setUint8(a,Number(b&BigInt(255))),b>>=BigInt(8));if(b)throw Error("Number does not fit in this length");return e},leBuff2int:function(b){let c=BigInt(0),a=0,d=new DataView(b.buffer,b.byteOffset,b.byteLength);for(;a<b.length;)a+4<=b.length?(c+=BigInt(d.getUint32(a,!0))<<BigInt(8*a),a+=4):a+4<=b.length?(c+=BigInt(d.getUint16(a,!0))<<BigInt(8*a),a+=2):(c+=BigInt(d.getUint8(a,!0))<<BigInt(8*a),a+=1);return c},leInt2Buff:function(e,b){let c=e;void 0===b&&0==(b=Math.floor((bitLength(e)-1)/8)+1)&&(b=1);let f=new Uint8Array(b),d=new DataView(f.buffer),a=0;for(;a<b;)a+4<=b?(d.setUint32(a,Number(c&BigInt(4294967295)),!0),a+=4,c>>=BigInt(32)):a+2<=b?(d.setUint16(Number(a,c&BigInt(65535)),!0),a+=2,c>>=BigInt(16)):(d.setUint8(Number(a,c&BigInt(255)),!0),a+=1,c>>=BigInt(8));if(c)throw Error("Number does not fit in this length");return f},stringifyFElements:stringifyFElements$1,unstringifyFElements:unstringifyFElements$1});function stringifyBigInts$1(a){if("bigint"==typeof a|| void 0!==a.eq)return a.toString(10);if(Array.isArray(a))return a.map(stringifyBigInts$1);if("object"!=typeof a)return a;{let b={},c=Object.keys(a);return c.forEach(c=>{b[c]=stringifyBigInts$1(a[c])}),b}}function unstringifyBigInts$1(a){if("string"==typeof a&&/^[0-9]+$/.test(a)||"string"==typeof a&&/^0x[0-9a-fA-F]+$/.test(a))return bigInt__default.default(a);if(Array.isArray(a))return a.map(unstringifyBigInts$1);{if("object"!=typeof a)return a;let b={},c=Object.keys(a);return c.forEach(c=>{b[c]=unstringifyBigInts$1(a[c])}),b}}var utils_bigint=Object.freeze({__proto__:null,stringifyBigInts:stringifyBigInts$1,unstringifyBigInts:unstringifyBigInts$1,beBuff2int:function(b){let c=bigInt__default.default.zero;for(let a=0;a<b.length;a++){let d=bigInt__default.default(b[b.length-a-1]);c=c.add(d.shiftLeft(8*a))}return c},beInt2Buff:function(e,c){let a=e,b=c-1,d=new Uint8Array(c);for(;a.gt(bigInt__default.default.zero)&&b>=0;){let f=Number(a.and(bigInt__default.default("255")));d[b]=f,b--,a=a.shiftRight(8)}if(!a.eq(bigInt__default.default.zero))throw Error("Number does not fit in this length");return d},leBuff2int:function(c){let b=bigInt__default.default.zero;for(let a=0;a<c.length;a++){let d=bigInt__default.default(c[a]);b=b.add(d.shiftLeft(8*a))}return b},leInt2Buff:function(d,e){let a=d,b=0,c=new Uint8Array(e);for(;a.gt(bigInt__default.default.zero)&&b<c.length;){let f=Number(a.and(bigInt__default.default(255)));c[b]=f,b++,a=a.shiftRight(8)}if(!a.eq(bigInt__default.default.zero))throw Error("Number does not fit in this length");return c}});let utils$1={},supportsNativeBigInt="function"==typeof BigInt;supportsNativeBigInt?Object.assign(utils$1,utils_native):Object.assign(utils$1,utils_bigint);let _revTable=[];for(let i=0;i<256;i++)_revTable[i]=_revSlow(i,8);function _revSlow(d,e){let a=0,b=d;for(let c=0;c<e;c++)a<<=1,a|=1&b,b>>=1;return a}utils$1.bitReverse=function(a,b){return(_revTable[a>>>24]|_revTable[a>>>16&255]<<8|_revTable[a>>>8&255]<<16|_revTable[255&a]<<24)>>>32-b},utils$1.log2=function(a){return((4294901760&a)!=0?(a&=4294901760,16):0)|((4278255360&a)!=0?(a&=4278255360,8):0)|((4042322160&a)!=0?(a&=4042322160,4):0)|((3435973836&a)!=0?(a&=3435973836,2):0)|(2863311530&a)!=0},utils$1.buffReverseBits=function(c,a){let e=c.byteLength/a,f=utils$1.log2(e);if(e!=1<<f)throw Error("Invalid number of pointers");for(let b=0;b<e;b++){let d=utils$1.bitReverse(b,f);if(b>d){let g=c.slice(b*a,(b+1)*a);c.set(c.slice(d*a,(d+1)*a),b*a),c.set(g,d*a)}}},utils$1.array2buffer=function(b,c){let d=new Uint8Array(c*b.length);for(let a=0;a<b.length;a++)d.set(b[a],a*c);return d},utils$1.buffer2array=function(c,b){let d=c.byteLength/b,e=Array(d);for(let a=0;a<d;a++)e[a]=c.slice(a*b,a*b+b);return e};let{bitReverse,log2,buffReverseBits,stringifyBigInts,unstringifyBigInts,beBuff2int,beInt2Buff,leBuff2int,leInt2Buff,array2buffer,buffer2array,stringifyFElements,unstringifyFElements}=utils$1;var _utils=Object.freeze({__proto__:null,bitReverse:bitReverse,log2:log2,buffReverseBits:buffReverseBits,stringifyBigInts:stringifyBigInts,unstringifyBigInts:unstringifyBigInts,beBuff2int:beBuff2int,beInt2Buff:beInt2Buff,leBuff2int:leBuff2int,leInt2Buff:leInt2Buff,array2buffer:array2buffer,buffer2array:buffer2array,stringifyFElements:stringifyFElements,unstringifyFElements:unstringifyFElements});let PAGE_SIZE=1073741824;class BigBuffer{constructor(a){this.buffers=[],this.byteLength=a;for(let b=0;b<a;b+=PAGE_SIZE){let c=Math.min(a-b,PAGE_SIZE);this.buffers.push(new Uint8Array(c))}}slice(b,f){void 0===f&&(f=this.byteLength),void 0===b&&(b=0);let a=f-b,g=Math.floor(b/PAGE_SIZE),k=Math.floor((b+a-1)/PAGE_SIZE);if(g==k||0==a)return this.buffers[g].slice(b%PAGE_SIZE,b%PAGE_SIZE+a);let d,h=g,e=b%PAGE_SIZE,c=a;for(;c>0;){let i=e+c>PAGE_SIZE?PAGE_SIZE-e:c,j=new Uint8Array(this.buffers[h].buffer,this.buffers[h].byteOffset+e,i);if(i==a)return j.slice();d||(d=a<=PAGE_SIZE?new Uint8Array(a):new BigBuffer(a)),d.set(j,a-c),c-=i,h++,e=0}return d}set(b,a){void 0===a&&(a=0);let d=b.byteLength;if(0==d)return;let e=Math.floor(a/PAGE_SIZE),i=Math.floor((a+d-1)/PAGE_SIZE);if(e==i)return b instanceof BigBuffer&&1==b.buffers.length?this.buffers[e].set(b.buffers[0],a%PAGE_SIZE):this.buffers[e].set(b,a%PAGE_SIZE);let g=e,f=a%PAGE_SIZE,c=d;for(;c>0;){let h=f+c>PAGE_SIZE?PAGE_SIZE-f:c,j=b.slice(d-c,d-c+h),k=new Uint8Array(this.buffers[g].buffer,this.buffers[g].byteOffset+f,h);k.set(j),c-=h,g++,f=0}}}function buildBatchConvert(a,b,c,d){return async function(h){let f=Math.floor(h.byteLength/c);if(f*c!==h.byteLength)throw Error("Invalid buffer size");let i=Math.floor(f/a.concurrency),m=[];for(let e=0;e<a.concurrency;e++){let g;if(0==(g=e<a.concurrency-1?i:f-e*i))continue;let o=h.slice(e*i*c,e*i*c+g*c),p=[{cmd:"ALLOCSET",var:0,buff:o},{cmd:"ALLOC",var:1,len:d*g},{cmd:"CALL",fnName:b,params:[{var:0},{val:g},{var:1}]},{cmd:"GET",out:0,var:1,len:d*g},];m.push(a.queueAction(p))}let k=await Promise.all(m),l;l=h instanceof BigBuffer?new BigBuffer(f*d):new Uint8Array(f*d);let n=0;for(let j=0;j<k.length;j++)l.set(k[j][0],n),n+=k[j][0].byteLength;return l}}class WasmField1{constructor(a,c,b,g){if(this.tm=a,this.prefix=c,this.p=g,this.n8=b,this.type="F1",this.m=1,this.half=shiftRight(g,one),this.bitLength=bitLength(g),this.mask=sub(shiftLeft(one,this.bitLength),one),this.pOp1=a.alloc(b),this.pOp2=a.alloc(b),this.pOp3=a.alloc(b),this.tm.instance.exports[c+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[c+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(b/8),this.n32=Math.floor(b/4),8*this.n64!=this.n8)throw Error("n8 must be a multiple of 8");this.half=shiftRight(this.p,one),this.nqr=this.two;let h=this.exp(this.nqr,this.half);for(;!this.eq(h,this.negone);)this.nqr=this.add(this.nqr,this.one),h=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let d=sub(this.p,one);for(;!isOdd(d);)this.s=this.s+1,d=shiftRight(d,one);this.w=[],this.w[this.s]=this.exp(this.nqr,d);for(let f=this.s-1;f>=0;f--)this.w[f]=this.square(this.w[f+1]);if(!this.eq(this.w[0],this.one))throw Error("Error calculating roots of unity");this.batchToMontgomery=buildBatchConvert(a,c+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=buildBatchConvert(a,c+"_batchFromMontgomery",this.n8,this.n8)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}add(a,b){return this.op2("_add",a,b)}eq(a,b){return this.op2Bool("_eq",a,b)}isZero(a){return this.op1Bool("_isZero",a)}sub(a,b){return this.op2("_sub",a,b)}neg(a){return this.op1("_neg",a)}inv(a){return this.op1("_inverse",a)}toMontgomery(a){return this.op1("_toMontgomery",a)}fromMontgomery(a){return this.op1("_fromMontgomery",a)}mul(a,b){return this.op2("_mul",a,b)}div(a,b){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(a){return this.op1("_square",a)}isSquare(a){return this.op1Bool("_isSquare",a)}sqrt(a){return this.op1("_sqrt",a)}exp(b,a){return a instanceof Uint8Array||(a=toLEBuff(e(a))),this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(a){return this.op1Bool("_isNegative",a)}e(b,c){if(b instanceof Uint8Array)return b;let a=e(b,c);isNegative(a)?(a=neg(a),gt(a,this.p)&&(a=mod(a,this.p)),a=sub(this.p,a)):gt(a,this.p)&&(a=mod(a,this.p));let d=leInt2Buff(a,this.n8);return this.toMontgomery(d)}toString(a,b){let c=this.fromMontgomery(a),d=fromRprLE(c,0);return toString(d,b)}fromRng(d){let a,c=new Uint8Array(this.n8);do{a=zero;for(let b=0;b<this.n64;b++)a=add(a,shiftLeft(d.nextU64(),64*b));a=band(a,this.mask)}while(geq(a,this.p))return toRprLE(c,0,a,this.n8),c}random(){return this.fromRng(getThreadRng())}toObject(a){let b=this.fromMontgomery(a);return fromRprLE(b,0)}fromObject(b){let a=new Uint8Array(this.n8);return toRprLE(a,0,b,this.n8),this.toMontgomery(a)}toRprLE(a,b,c){a.set(this.fromMontgomery(c),b)}toRprBE(c,d,f){let b=this.fromMontgomery(f);for(let a=0;a<this.n8/2;a++){let g=b[a];b[a]=b[this.n8-1-a],b[this.n8-1-a]=g}c.set(b,d)}fromRprLE(b,a){a=a||0;let c=b.slice(a,a+this.n8);return this.toMontgomery(c)}async batchInverse(a){let l=!1,b=this.n8,c=this.n8;Array.isArray(a)?(a=array2buffer(a,b),l=!0):a=a.slice(0,a.byteLength);let f=Math.floor(a.byteLength/b);if(f*b!==a.byteLength)throw Error("Invalid buffer size");let h=Math.floor(f/this.tm.concurrency),m=[];for(let d=0;d<this.tm.concurrency;d++){let g;if(0==(g=d<this.tm.concurrency-1?h:f-d*h))continue;let o=a.slice(d*h*b,d*h*b+g*b),p=[{cmd:"ALLOCSET",var:0,buff:o},{cmd:"ALLOC",var:1,len:c*g},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:b},{val:g},{var:1},{val:c},]},{cmd:"GET",out:0,var:1,len:c*g},];m.push(this.tm.queueAction(p))}let k=await Promise.all(m),i;i=a instanceof BigBuffer?new BigBuffer(f*c):new Uint8Array(f*c);let n=0;for(let j=0;j<k.length;j++)i.set(k[j][0],n),n+=k[j][0].byteLength;return l?buffer2array(i,c):i}}class WasmField2{constructor(a,c,b){this.tm=a,this.prefix=c,this.F=b,this.type="F2",this.m=2*b.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=a.alloc(2*b.n8),this.pOp2=a.alloc(2*b.n8),this.pOp3=a.alloc(2*b.n8),this.tm.instance.exports[c+"_zero"](this.pOp1),this.zero=a.getBuff(this.pOp1,this.n8),this.tm.instance.exports[c+"_one"](this.pOp1),this.one=a.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}add(a,b){return this.op2("_add",a,b)}eq(a,b){return this.op2Bool("_eq",a,b)}isZero(a){return this.op1Bool("_isZero",a)}sub(a,b){return this.op2("_sub",a,b)}neg(a){return this.op1("_neg",a)}inv(a){return this.op1("_inverse",a)}isNegative(a){return this.op1Bool("_isNegative",a)}toMontgomery(a){return this.op1("_toMontgomery",a)}fromMontgomery(a){return this.op1("_fromMontgomery",a)}mul(a,b){return this.op2("_mul",a,b)}mul1(a,b){return this.op2("_mul1",a,b)}div(a,b){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(a){return this.op1("_square",a)}isSquare(a){return this.op1Bool("_isSquare",a)}sqrt(a){return this.op1("_sqrt",a)}exp(b,a){return a instanceof Uint8Array||(a=toLEBuff(e(a))),this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(a,c){if(a instanceof Uint8Array)return a;if(Array.isArray(a)&&2==a.length){let d=this.F.e(a[0],c),f=this.F.e(a[1],c),b=new Uint8Array(2*this.F.n8);return b.set(d),b.set(f,2*this.F.n8),b}throw Error("invalid F2")}toString(a,b){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8),b);return`[${c}, ${d}]`}fromRng(b){let c=this.F.fromRng(b),d=this.F.fromRng(b),a=new Uint8Array(2*this.F.n8);return a.set(c),a.set(d,this.F.n8),a}random(){return this.fromRng(getThreadRng())}toObject(a){let b=this.F.toObject(a.slice(0,this.F.n8)),c=this.F.toObject(a.slice(this.F.n8,2*this.F.n8));return[b,c]}fromObject(b){let a=new Uint8Array(2*this.F.n8),c=this.F.fromObject(b[0]),d=this.F.fromObject(b[1]);return a.set(c),a.set(d,this.F.n8),a}c1(a){return a.slice(0,this.F.n8)}c2(a){return a.slice(this.F.n8)}}class WasmField3{constructor(a,c,b){this.tm=a,this.prefix=c,this.F=b,this.type="F3",this.m=3*b.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=a.alloc(3*b.n8),this.pOp2=a.alloc(3*b.n8),this.pOp3=a.alloc(3*b.n8),this.tm.instance.exports[c+"_zero"](this.pOp1),this.zero=a.getBuff(this.pOp1,this.n8),this.tm.instance.exports[c+"_one"](this.pOp1),this.one=a.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}eq(a,b){return this.op2Bool("_eq",a,b)}isZero(a){return this.op1Bool("_isZero",a)}add(a,b){return this.op2("_add",a,b)}sub(a,b){return this.op2("_sub",a,b)}neg(a){return this.op1("_neg",a)}inv(a){return this.op1("_inverse",a)}isNegative(a){return this.op1Bool("_isNegative",a)}toMontgomery(a){return this.op1("_toMontgomery",a)}fromMontgomery(a){return this.op1("_fromMontgomery",a)}mul(a,b){return this.op2("_mul",a,b)}div(a,b){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,b),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(a){return this.op1("_square",a)}isSquare(a){return this.op1Bool("_isSquare",a)}sqrt(a){return this.op1("_sqrt",a)}exp(b,a){return a instanceof Uint8Array||(a=toLEBuff(e(a))),this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(a,c){if(a instanceof Uint8Array)return a;if(Array.isArray(a)&&3==a.length){let d=this.F.e(a[0],c),f=this.F.e(a[1],c),g=this.F.e(a[2],c),b=new Uint8Array(3*this.F.n8);return b.set(d),b.set(f,this.F.n8),b.set(g,2*this.F.n8),b}throw Error("invalid F3")}toString(a,b){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8,2*this.F.n8),b),f=this.F.toString(a.slice(2*this.F.n8),b);return`[${c}, ${d}, ${f}]`}fromRng(b){let c=this.F.fromRng(b),d=this.F.fromRng(b),f=this.F.fromRng(b),a=new Uint8Array(3*this.F.n8);return a.set(c),a.set(d,this.F.n8),a.set(f,2*this.F.n8),a}random(){return this.fromRng(getThreadRng())}toObject(a){let b=this.F.toObject(a.slice(0,this.F.n8)),c=this.F.toObject(a.slice(this.F.n8,2*this.F.n8)),d=this.F.toObject(a.slice(2*this.F.n8,3*this.F.n8));return[b,c,d]}fromObject(b){let a=new Uint8Array(3*this.F.n8),c=this.F.fromObject(b[0]),d=this.F.fromObject(b[1]),f=this.F.fromObject(b[2]);return a.set(c),a.set(d,this.F.n8),a.set(f,2*this.F.n8),a}c1(a){return a.slice(0,this.F.n8)}c2(a){return a.slice(this.F.n8,2*this.F.n8)}c3(a){return a.slice(2*this.F.n8)}}class WasmCurve{constructor(b,c,a,d,g,f){this.tm=b,this.prefix=c,this.F=a,this.pOp1=b.alloc(3*a.n8),this.pOp2=b.alloc(3*a.n8),this.pOp3=b.alloc(3*a.n8),this.tm.instance.exports[c+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*a.n8),this.tm.instance.exports[c+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*a.n8),this.one=this.tm.getBuff(d,3*a.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(d,2*a.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(g,a.n8),f&&(this.cofactor=toLEBuff(f)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=buildBatchConvert(b,c+"_batchLEMtoC",2*a.n8,a.n8),this.batchLEMtoU=buildBatchConvert(b,c+"_batchLEMtoU",2*a.n8,2*a.n8),this.batchCtoLEM=buildBatchConvert(b,c+"_batchCtoLEM",a.n8,2*a.n8),this.batchUtoLEM=buildBatchConvert(b,c+"_batchUtoLEM",2*a.n8,2*a.n8),this.batchToJacobian=buildBatchConvert(b,c+"_batchToJacobian",2*a.n8,3*a.n8),this.batchToAffine=buildBatchConvert(b,c+"_batchToAffine",3*a.n8,2*a.n8)}op2(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(a,b,c){return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,c),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp2,this.pOp3)}op1(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(a,b){return this.tm.setBuff(this.pOp1,b),this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(a,b){return this.tm.setBuff(this.pOp1,b),!!this.tm.instance.exports[this.prefix+a](this.pOp1,this.pOp3)}add(b,a){if(b.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_add",b,a);if(a.byteLength==2*this.F.n8)return this.op2("_addMixed",b,a);throw Error("invalid point size")}if(b.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_addMixed",a,b);if(a.byteLength==2*this.F.n8)return this.op2("_addAffine",b,a)}throw Error("invalid point size")}sub(b,a){if(b.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_sub",b,a);if(a.byteLength==2*this.F.n8)return this.op2("_subMixed",b,a);throw Error("invalid point size")}if(b.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_subMixed",a,b);if(a.byteLength==2*this.F.n8)return this.op2("_subAffine",b,a)}throw Error("invalid point size")}neg(a){if(a.byteLength==3*this.F.n8)return this.op1("_neg",a);if(a.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",a);throw Error("invalid point size")}double(a){if(a.byteLength==3*this.F.n8)return this.op1("_double",a);if(a.byteLength==2*this.F.n8)return this.op1("_doubleAffine",a);throw Error("invalid point size")}isZero(a){if(a.byteLength==3*this.F.n8)return this.op1Bool("_isZero",a);if(a.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",a);throw Error("invalid point size")}timesScalar(b,a){a instanceof Uint8Array||(a=toLEBuff(e(a)));let c;if(b.byteLength==3*this.F.n8)c=this.prefix+"_timesScalar";else if(b.byteLength==2*this.F.n8)c=this.prefix+"_timesScalarAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,b),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[c](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(a,c){let b;if(a.byteLength==3*this.F.n8)b=this.prefix+"_timesFr";else if(a.byteLength==2*this.F.n8)b=this.prefix+"_timesFrAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,c),this.tm.instance.exports[b](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(b,a){if(b.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2bool("_eq",b,a);if(a.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",b,a);throw Error("invalid point size")}if(b.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",a,b);if(a.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",b,a)}throw Error("invalid point size")}toAffine(a){if(a.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",a);if(a.byteLength==2*this.F.n8)return a;throw Error("invalid point size")}toJacobian(a){if(a.byteLength==3*this.F.n8)return a;if(a.byteLength==2*this.F.n8)return this.op1("_toJacobian",a);throw Error("invalid point size")}toRprUncompressed(b,c,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let d=this.tm.getBuff(this.pOp1,2*this.F.n8);b.set(d,c)}fromRprUncompressed(b,a){let c=b.slice(a,a+2*this.F.n8);return this.tm.setBuff(this.pOp1,c),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(b,c,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let d=this.tm.getBuff(this.pOp1,this.F.n8);b.set(d,c)}fromRprCompressed(b,a){let c=b.slice(a,a+this.F.n8);return this.tm.setBuff(this.pOp1,c),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(b){let a=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(a,0,b),a}toRprLEM(b,c,a){if(a.byteLength==2*this.F.n8){b.set(a,c);return}if(a.byteLength==3*this.F.n8){this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let d=this.tm.getBuff(this.pOp1,2*this.F.n8);b.set(d,c)}else throw Error("invalid point size")}fromRprLEM(b,a){return a=a||0,b.slice(a,a+2*this.F.n8)}toString(a,b){if(a.byteLength==3*this.F.n8){let c=this.F.toString(a.slice(0,this.F.n8),b),d=this.F.toString(a.slice(this.F.n8,2*this.F.n8),b),f=this.F.toString(a.slice(2*this.F.n8),b);return`[ ${c}, ${d}, ${f} ]`}if(a.byteLength==2*this.F.n8){let g=this.F.toString(a.slice(0,this.F.n8),b),h=this.F.toString(a.slice(this.F.n8),b);return`[ ${g}, ${h} ]`}throw Error("invalid point size")}isValid(b){if(this.isZero(b))return!0;let a=this.F,c=this.toAffine(b),d=c.slice(0,this.F.n8),f=c.slice(this.F.n8,2*this.F.n8),g=a.add(a.mul(a.square(d),d),this.b),h=a.square(f);return a.eq(g,h)}fromRng(f){let b=this.F,a=[],g,d;do a[0]=b.fromRng(f),g=f.nextBool(),d=b.add(b.mul(b.square(a[0]),a[0]),this.b);while(!b.isSquare(d))a[1]=b.sqrt(d);let h=b.isNegative(a[1]);g^h&&(a[1]=b.neg(a[1]));let c=new Uint8Array(2*this.F.n8);return c.set(a[0]),c.set(a[1],this.F.n8),this.cofactor&&(c=this.timesScalar(c,this.cofactor)),c}toObject(a){if(this.isZero(a))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero),];let b=this.F.toObject(a.slice(0,this.F.n8)),c=this.F.toObject(a.slice(this.F.n8,2*this.F.n8)),d;return[b,c,a.byteLength==3*this.F.n8?this.F.toObject(a.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one)]}fromObject(a){let f=this.F.fromObject(a[0]),g=this.F.fromObject(a[1]),b;if(b=3==a.length?this.F.fromObject(a[2]):this.F.one,this.F.isZero(b,this.F.one))return this.zeroAffine;if(this.F.eq(b,this.F.one)){let d=new Uint8Array(2*this.F.n8);return d.set(f),d.set(g,this.F.n8),d}{let c=new Uint8Array(3*this.F.n8);return c.set(f),c.set(g,this.F.n8),c.set(b,2*this.F.n8),c}}e(a){return a instanceof Uint8Array?a:this.fromObject(a)}x(a){let b=this.toAffine(a);return b.slice(0,this.F.n8)}y(a){let b=this.toAffine(a);return b.slice(this.F.n8)}}function thread(a){let c,d;async function e(a){let b=new Uint8Array(a.code),e=await WebAssembly.compile(b);d=new WebAssembly.Memory({initial:a.init,maximum:32767}),c=await WebAssembly.instantiate(e,{env:{memory:d}})}function f(b){let a=new Uint32Array(d.buffer,0,1);for(;3&a[0];)a[0]++;let e=a[0];if(a[0]+=b,a[0]+b>d.buffer.byteLength){let f=d.buffer.byteLength/65536,c=Math.floor((a[0]+b)/65536)+1;c>32767&&(c=32767),d.grow(c-f)}return e}function g(a){let b=f(a.byteLength);return i(b,a),b}function h(b,c){let a=new Uint8Array(d.buffer);return new Uint8Array(a.buffer,a.byteOffset+b,c)}function i(a,b){let c=new Uint8Array(d.buffer);c.set(new Uint8Array(b),a)}function b(a){if("INIT"==a[0].cmd)return e(a[0]);let j={vars:[],out:[]},n=new Uint32Array(d.buffer,0,1),o=n[0];for(let b=0;b<a.length;b++)switch(a[b].cmd){case"ALLOCSET":j.vars[a[b].var]=g(a[b].buff);break;case"ALLOC":j.vars[a[b].var]=f(a[b].len);break;case"SET":i(j.vars[a[b].var],a[b].buff);break;case"CALL":{let l=[];for(let m=0;m<a[b].params.length;m++){let k=a[b].params[m];void 0!==k.var?l.push(j.vars[k.var]+(k.offset||0)):void 0!==k.val&&l.push(k.val)}c.exports[a[b].fnName](...l);break}case"GET":j.out[a[b].out]=h(j.vars[a[b].var],a[b].len).slice();break;default:throw Error("Invalid cmd")}let p=new Uint32Array(d.buffer,0,1);return p[0]=o,j.out}return a&&(a.onmessage=function(d){let c;if("INIT"==(c=d.data?d.data:d)[0].cmd)e(c[0]).then(function(){a.postMessage(c.result)});else if("TERMINATE"==c[0].cmd)a.close();else{let f=b(c);a.postMessage(f)}}),b}class Deferred{constructor(){this.promise=new Promise((a,b)=>{this.reject=b,this.resolve=a})}}let threadSource=globalThis.btoa(str="("+thread.toString()+")(self)"),workerSource="data:application/javascript;base64,"+threadSource;async function buildThreadManager(b,f){let a=new ThreadManager;a.memory=new WebAssembly.Memory({initial:25}),a.u8=new Uint8Array(a.memory.buffer),a.u32=new Uint32Array(a.memory.buffer);let i=await WebAssembly.compile(b.code);if(a.instance=await WebAssembly.instantiate(i,{env:{memory:a.memory}}),a.singleThread=f,a.initalPFree=a.u32[0],a.pq=b.pq,a.pr=b.pr,a.pG1gen=b.pG1gen,a.pG1zero=b.pG1zero,a.pG2gen=b.pG2gen,a.pG2zero=b.pG2zero,a.pOneT=b.pOneT,f)a.code=b.code,a.taskManager=thread(),await a.taskManager([{cmd:"INIT",init:25,code:a.code.slice()}]),a.concurrency=1;else{a.workers=[],a.pendingDeferreds=[],a.working=[];let c;0==(c="object"==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:os__default.default.cpus().length)&&(c=2),c>64&&(c=64),a.concurrency=c;for(let d=0;d<c;d++)a.workers[d]=new Worker__default.default(workerSource),a.workers[d].addEventListener("message",j(d)),a.working[d]=!1;let g=[];for(let e=0;e<a.workers.length;e++){let h=b.code.slice();g.push(a.postAction(e,[{cmd:"INIT",init:25,code:h}],[h.buffer]))}await Promise.all(g)}return a;function j(b){return function(c){let d;d=c&&c.data?c.data:c,a.working[b]=!1,a.pendingDeferreds[b].resolve(d),a.processWorks()}}}class ThreadManager{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(a,b,c,d){if(this.working[a])throw Error("Posting a job t a working worker");return this.working[a]=!0,this.pendingDeferreds[a]=d||new Deferred,this.workers[a].postMessage(b,c),this.pendingDeferreds[a].promise}processWorks(){for(let a=0;a<this.workers.length&&this.actionQueue.length>0;a++)if(!1==this.working[a]){let b=this.actionQueue.shift();this.postAction(a,b.data,b.transfers,b.deferred)}}queueAction(b,c){let a=new Deferred;if(this.singleThread){let d=this.taskManager(b);a.resolve(d)}else this.actionQueue.push({data:b,transfers:c,deferred:a}),this.processWorks();return a.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(a){let b=this.alloc(a.byteLength);return this.setBuff(b,a),b}getBuff(a,b){return this.u8.slice(a,a+b)}setBuff(a,b){this.u8.set(new Uint8Array(b),a)}alloc(a){for(;3&this.u32[0];)this.u32[0]++;let b=this.u32[0];return this.u32[0]+=a,b}async terminate(){var b;for(let a=0;a<this.workers.length;a++)this.workers[a].postMessage([{cmd:"TERMINATE"}]);await new Promise(a=>setTimeout(a,200))}}function buildBatchApplyKey(a,b){let c=a[b],d=a.Fr,e=a.tm;a[b].batchApplyKey=async function(s,y,k,l,m){l=l||"affine",m=m||"affine";let i,n,a,o,f;if("G1"==b)"jacobian"==l?(a=3*c.F.n8,i="g1m_batchApplyKey"):(a=2*c.F.n8,i="g1m_batchApplyKeyMixed"),o=3*c.F.n8,"jacobian"==m?f=3*c.F.n8:(n="g1m_batchToAffine",f=2*c.F.n8);else if("G2"==b)"jacobian"==l?(a=3*c.F.n8,i="g2m_batchApplyKey"):(a=2*c.F.n8,i="g2m_batchApplyKeyMixed"),o=3*c.F.n8,"jacobian"==m?f=3*c.F.n8:(n="g2m_batchToAffine",f=2*c.F.n8);else if("Fr"==b)i="frm_batchApplyKey",a=c.n8,o=c.n8,f=c.n8;else throw Error("Invalid group: "+b);let p=Math.floor(s.byteLength/a),q=Math.floor(p/e.concurrency),w=[];k=d.e(k);let t=d.e(y);for(let j=0;j<e.concurrency;j++){let h;if(0==(h=j<e.concurrency-1?q:p-j*q))continue;let g=[];g.push({cmd:"ALLOCSET",var:0,buff:s.slice(j*q*a,j*q*a+h*a)}),g.push({cmd:"ALLOCSET",var:1,buff:t}),g.push({cmd:"ALLOCSET",var:2,buff:k}),g.push({cmd:"ALLOC",var:3,len:h*Math.max(o,f)}),g.push({cmd:"CALL",fnName:i,params:[{var:0},{val:h},{var:1},{var:2},{var:3}]}),n&&g.push({cmd:"CALL",fnName:n,params:[{var:3},{val:h},{var:3},]}),g.push({cmd:"GET",out:0,var:3,len:h*f}),w.push(e.queueAction(g)),t=d.mul(t,d.exp(k,h))}let u=await Promise.all(w),v;v=s instanceof BigBuffer?new BigBuffer(p*f):new Uint8Array(p*f);let x=0;for(let r=0;r<u.length;r++)v.set(u[r][0],x),x+=u[r][0].byteLength;return v}}let pTSizes=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function buildMultiexp(b,c){let a=b[c],d=a.tm;async function e(n,h,i,j,k){if(!(n instanceof Uint8Array))throw j&&j.error(`${k} _multiExpChunk buffBases is not Uint8Array`),Error(`${k} _multiExpChunk buffBases is not Uint8Array`);if(!(h instanceof Uint8Array))throw j&&j.error(`${k} _multiExpChunk buffScalars is not Uint8Array`),Error(`${k} _multiExpChunk buffScalars is not Uint8Array`);i=i||"affine";let d,e;if("G1"==c)"affine"==i?(e="g1m_multiexpAffine_chunk",d=2*a.F.n8):(e="g1m_multiexp_chunk",d=3*a.F.n8);else if("G2"==c)"affine"==i?(e="g2m_multiexpAffine_chunk",d=2*a.F.n8):(e="g2m_multiexp_chunk",d=3*a.F.n8);else throw Error("Invalid group");let f=Math.floor(n.byteLength/d);if(0==f)return a.zero;let l=Math.floor(h.byteLength/f);if(l*f!=h.byteLength)throw Error("Scalar size does not match");let g=pTSizes[log2(f)],s=Math.floor((8*l-1)/g)+1,p=[];for(let m=0;m<s;m++){let t=[{cmd:"ALLOCSET",var:0,buff:n},{cmd:"ALLOCSET",var:1,buff:h},{cmd:"ALLOC",var:2,len:3*a.F.n8},{cmd:"CALL",fnName:e,params:[{var:0},{var:1},{val:l},{val:f},{val:m*g},{val:Math.min(8*l-m*g,g)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*a.F.n8}];p.push(a.tm.queueAction(t))}let q=await Promise.all(p),b=a.zero;for(let o=q.length-1;o>=0;o--){if(!a.isZero(b))for(let r=0;r<g;r++)b=a.double(b);b=a.add(b,q[o][0])}return b}async function f(o,j,k,l,p){let h;if("G1"==c)h="affine"==k?2*a.F.n8:3*a.F.n8;else if("G2"==c)h="affine"==k?2*a.F.n8:3*a.F.n8;else throw Error("Invalid group");let f=Math.floor(o.byteLength/h),i=Math.floor(j.byteLength/f);if(i*f!=j.byteLength)throw Error("Scalar size does not match");let t=pTSizes[log2(f)],g;(g=Math.floor(f/(d.concurrency/(Math.floor((8*i-1)/t)+1))))>4194304&&(g=4194304),g<1024&&(g=1024);let q=[];for(let b=0;b<f;b+=g){l&&l.debug(`Multiexp start: ${p}: ${b}/${f}`);let r=Math.min(f-b,g),u=o.slice(b*h,(b+r)*h),v=j.slice(b*i,(b+r)*i);q.push(e(u,v,k,l,p).then(a=>(l&&l.debug(`Multiexp end: ${p}: ${b}/${f}`),a)))}let s=await Promise.all(q),m=a.zero;for(let n=s.length-1;n>=0;n--)m=a.add(m,s[n]);return m}a.multiExp=async function(a,b,c,d){return await f(a,b,"jacobian",c,d)},a.multiExpAffine=async function(a,b,c,d){return await f(a,b,"affine",c,d)}}function buildFFT(b,c){let a=b[c],d=b.Fr,e=a.tm;async function f(k,w,x,y,z,D){x=x||"affine",y=y||"affine";let W=14,l,r,f,E,s,F,G,o;"G1"==c?("affine"==x?(l=2*a.F.n8,E="g1m_batchToJacobian"):l=3*a.F.n8,r=3*a.F.n8,w&&(o="g1m_fftFinal"),G="g1m_fftJoin",F="g1m_fftMix","affine"==y?(f=2*a.F.n8,s="g1m_batchToAffine"):f=3*a.F.n8):"G2"==c?("affine"==x?(l=2*a.F.n8,E="g2m_batchToJacobian"):l=3*a.F.n8,r=3*a.F.n8,w&&(o="g2m_fftFinal"),G="g2m_fftJoin",F="g2m_fftMix","affine"==y?(f=2*a.F.n8,s="g2m_batchToAffine"):f=3*a.F.n8):"Fr"==c&&(l=a.n8,r=a.n8,f=a.n8,w&&(o="frm_fftFinal"),F="frm_fftMix",G="frm_fftJoin");let M=!1;Array.isArray(k)?(k=array2buffer(k,l),M=!0):k=k.slice(0,k.byteLength);let t=k.byteLength/l,n=log2(t);if(1<<n!=t)throw Error("fft must be multiple of 2");if(n==d.s+1){let N;return(N=w?await h(k,x,y,z,D):await g(k,x,y,z,D),M)?buffer2array(N,f):N}let O;w&&(O=d.inv(d.e(t)));let u;buffReverseBits(k,l);let j,b=Math.min(1<<W,t),p=t/b;for(;p<e.concurrency&&b>=16;)p*=2,b/=2;let P=log2(b),T=[];for(let A=0;A<p;A++){z&&z.debug(`${D}: fft ${n} mix start: ${A}/${p}`);let m=[];m.push({cmd:"ALLOC",var:0,len:r*b});let X=k.slice(b*A*l,b*(A+1)*l);m.push({cmd:"SET",var:0,buff:X}),E&&m.push({cmd:"CALL",fnName:E,params:[{var:0},{val:b},{var:0}]});for(let Q=1;Q<=P;Q++)m.push({cmd:"CALL",fnName:F,params:[{var:0},{val:b},{val:Q}]});P==n?(o&&(m.push({cmd:"ALLOCSET",var:1,buff:O}),m.push({cmd:"CALL",fnName:o,params:[{var:0},{val:b},{var:1},]})),s&&m.push({cmd:"CALL",fnName:s,params:[{var:0},{val:b},{var:0}]}),m.push({cmd:"GET",out:0,var:0,len:b*f})):m.push({cmd:"GET",out:0,var:0,len:r*b}),T.push(e.queueAction(m).then(a=>(z&&z.debug(`${D}: fft ${n} mix end: ${A}/${p}`),a)))}j=await Promise.all(T);for(let H=0;H<p;H++)j[H]=j[H][0];for(let v=P+1;v<=n;v++){z&&z.debug(`${D}: fft  ${n}  join: ${v}/${n}`);let R=1<<n-v,q=p/R,U=[];for(let I=0;I<R;I++)for(let B=0;B<q/2;B++){let Y=d.exp(d.w[v],B*b),Z=d.w[v],$=I*q+B,_=I*q+B+q/2,i=[];i.push({cmd:"ALLOCSET",var:0,buff:j[$]}),i.push({cmd:"ALLOCSET",var:1,buff:j[_]}),i.push({cmd:"ALLOCSET",var:2,buff:Y}),i.push({cmd:"ALLOCSET",var:3,buff:Z}),i.push({cmd:"CALL",fnName:G,params:[{var:0},{var:1},{val:b},{var:2},{var:3}]}),v==n?(o&&(i.push({cmd:"ALLOCSET",var:4,buff:O}),i.push({cmd:"CALL",fnName:o,params:[{var:0},{val:b},{var:4},]}),i.push({cmd:"CALL",fnName:o,params:[{var:1},{val:b},{var:4},]})),s&&(i.push({cmd:"CALL",fnName:s,params:[{var:0},{val:b},{var:0}]}),i.push({cmd:"CALL",fnName:s,params:[{var:1},{val:b},{var:1}]})),i.push({cmd:"GET",out:0,var:0,len:b*f}),i.push({cmd:"GET",out:1,var:1,len:b*f})):(i.push({cmd:"GET",out:0,var:0,len:b*r}),i.push({cmd:"GET",out:1,var:1,len:b*r})),U.push(e.queueAction(i).then(a=>(z&&z.debug(`${D}: fft ${n} join  ${v}/${n}  ${I+1}/${R} ${B}/${q/2}`),a)))}let aa=await Promise.all(U);for(let J=0;J<R;J++)for(let K=0;K<q/2;K++){let ab=J*q+K,ac=J*q+K+q/2,V=aa.shift();j[ab]=V[0],j[ac]=V[1]}}if(u=k instanceof BigBuffer?new BigBuffer(t*f):new Uint8Array(t*f),w){u.set(j[0].slice((b-1)*f));let S=f;for(let L=p-1;L>0;L--)u.set(j[L],S),S+=b*f,delete j[L];u.set(j[0].slice(0,(b-1)*f),S),delete j[0]}else for(let C=0;C<p;C++)u.set(j[C],b*f*C),delete j[C];return M?buffer2array(u,f):u}async function g(b,m,l,g,h){let c,e;c=b.slice(0,b.byteLength/2),e=b.slice(b.byteLength/2,b.byteLength);let j=[];[c,e]=await i(c,e,"fftJoinExt",d.one,d.shift,m,"jacobian",g,h),j.push(f(c,!1,"jacobian",l,g,h)),j.push(f(e,!1,"jacobian",l,g,h));let a=await Promise.all(j),k;return(k=a[0].byteLength>268435456?new BigBuffer(2*a[0].byteLength):new Uint8Array(2*a[0].byteLength)).set(a[0]),k.set(a[1],a[0].byteLength),k}async function h(b,l,m,g,h){let c,e;c=b.slice(0,b.byteLength/2),e=b.slice(b.byteLength/2,b.byteLength);let j=[];j.push(f(c,!0,l,"jacobian",g,h)),j.push(f(e,!0,l,"jacobian",g,h)),[c,e]=await Promise.all(j);let a=await i(c,e,"fftJoinExtInv",d.one,d.shiftInv,"jacobian",m,g,h),k;return(k=a[0].byteLength>268435456?new BigBuffer(2*a[0].byteLength):new Uint8Array(2*a[0].byteLength)).set(a[0]),k.set(a[1],a[0].byteLength),k}async function i(t,w,u,C,x,y,z,A,D){let p,l,m,f,i,n;if("G1"==c)"affine"==y?(i=2*a.F.n8,l="g1m_batchToJacobian"):i=3*a.F.n8,n=3*a.F.n8,p="g1m_"+u,"affine"==z?(m="g1m_batchToAffine",f=2*a.F.n8):f=3*a.F.n8;else if("G2"==c)"affine"==y?(i=2*a.F.n8,l="g2m_batchToJacobian"):i=3*a.F.n8,p="g2m_"+u,n=3*a.F.n8,"affine"==z?(m="g2m_batchToAffine",f=2*a.F.n8):f=3*a.F.n8;else if("Fr"==c)i=d.n8,f=d.n8,n=d.n8,p="frm_"+u;else throw Error("Invalid group");if(t.byteLength!=w.byteLength)throw Error("Invalid buffer size");let g=Math.floor(t.byteLength/i);if(g!=1<<log2(g))throw Error("Invalid number of points");let k=Math.floor(g/e.concurrency);k<16&&(k=16),k>65536&&(k=65536);let B=[];for(let j=0;j<g;j+=k){A&&A.debug(`${D}: fftJoinExt Start: ${j}/${g}`);let h=Math.min(g-j,k),E=d.mul(C,d.exp(x,j)),b=[],F=t.slice(j*i,(j+h)*i),G=w.slice(j*i,(j+h)*i);b.push({cmd:"ALLOC",var:0,len:n*h}),b.push({cmd:"SET",var:0,buff:F}),b.push({cmd:"ALLOC",var:1,len:n*h}),b.push({cmd:"SET",var:1,buff:G}),b.push({cmd:"ALLOCSET",var:2,buff:E}),b.push({cmd:"ALLOCSET",var:3,buff:x}),l&&(b.push({cmd:"CALL",fnName:l,params:[{var:0},{val:h},{var:0}]}),b.push({cmd:"CALL",fnName:l,params:[{var:1},{val:h},{var:1}]})),b.push({cmd:"CALL",fnName:p,params:[{var:0},{var:1},{val:h},{var:2},{var:3},{val:d.s},]}),m&&(b.push({cmd:"CALL",fnName:m,params:[{var:0},{val:h},{var:0}]}),b.push({cmd:"CALL",fnName:m,params:[{var:1},{val:h},{var:1}]})),b.push({cmd:"GET",out:0,var:0,len:h*f}),b.push({cmd:"GET",out:1,var:1,len:h*f}),B.push(e.queueAction(b).then(a=>(A&&A.debug(`${D}: fftJoinExt End: ${j}/${g}`),a)))}let q=await Promise.all(B),r,s;g*f>268435456?(r=new BigBuffer(g*f),s=new BigBuffer(g*f)):(r=new Uint8Array(g*f),s=new Uint8Array(g*f));let v=0;for(let o=0;o<q.length;o++)r.set(q[o][0],v),s.set(q[o][1],v),v+=q[o][0].byteLength;return[r,s]}a.fft=async function(a,b,c,d,e){return await f(a,!1,b,c,d,e)},a.ifft=async function(a,b,c,d,e){return await f(a,!0,b,c,d,e)},a.lagrangeEvaluations=async function(e,h,j,g,m){h=h||"affine",j=j||"affine";let k;if("G1"==c)k="affine"==h?2*a.F.n8:3*a.F.n8;else if("G2"==c)k="affine"==h?2*a.F.n8:3*a.F.n8;else if("Fr"==c)k=d.n8;else throw Error("Invalid group");let q=e.byteLength/k,n=log2(q);if(2**n*k!=e.byteLength)throw g&&g.error("lagrangeEvaluations iinvalid input size"),Error("lagrangeEvaluations invalid Input size");if(n<=d.s)return await a.ifft(e,h,j,g,m);if(n>d.s+1)throw g&&g.error("lagrangeEvaluations input too big"),Error("lagrangeEvaluations input too big");let b=e.slice(0,e.byteLength/2),l=e.slice(e.byteLength/2,e.byteLength),r=d.exp(d.shift,q/2),s=d.inv(d.sub(d.one,r));[b,l]=await i(b,l,"prepareLagrangeEvaluation",s,d.shiftInv,h,"jacobian",g,m+" prep");let o=[];o.push(f(b,!0,"jacobian",j,g,m+" t0")),o.push(f(l,!0,"jacobian",j,g,m+" t1")),[b,l]=await Promise.all(o);let p;return(p=b.byteLength>268435456?new BigBuffer(2*b.byteLength):new Uint8Array(2*b.byteLength)).set(b),p.set(l,b.byteLength),p},a.fftMix=async function(w){let f=3*a.F.n8,n,o;if("G1"==c)n="g1m_fftMix",o="g1m_fftJoin";else if("G2"==c)n="g2m_fftMix",o="g2m_fftJoin";else if("Fr"==c)n="frm_fftMix",o="frm_fftJoin";else throw Error("Invalid group");let k=Math.floor(w.byteLength/f),A=log2(k),j=1<<log2(e.concurrency);k<=2*j&&(j=1);let b=k/j,B=log2(b),C=[];for(let p=0;p<j;p++){let q=[],H=w.slice(p*b*f,(p+1)*b*f);q.push({cmd:"ALLOCSET",var:0,buff:H});for(let x=1;x<=B;x++)q.push({cmd:"CALL",fnName:n,params:[{var:0},{val:b},{val:x}]});q.push({cmd:"GET",out:0,var:0,len:b*f}),C.push(e.queueAction(q))}let D=await Promise.all(C),i=[];for(let r=0;r<D.length;r++)i[r]=D[r][0];for(let l=B+1;l<=A;l++){let y=1<<A-l,g=j/y,E=[];for(let s=0;s<y;s++)for(let m=0;m<g/2;m++){let I=d.exp(d.w[l],m*b),J=d.w[l],K=s*g+m,L=s*g+m+g/2,h=[];h.push({cmd:"ALLOCSET",var:0,buff:i[K]}),h.push({cmd:"ALLOCSET",var:1,buff:i[L]}),h.push({cmd:"ALLOCSET",var:2,buff:I}),h.push({cmd:"ALLOCSET",var:3,buff:J}),h.push({cmd:"CALL",fnName:o,params:[{var:0},{var:1},{val:b},{var:2},{var:3}]}),h.push({cmd:"GET",out:0,var:0,len:b*f}),h.push({cmd:"GET",out:1,var:1,len:b*f}),E.push(e.queueAction(h))}let M=await Promise.all(E);for(let t=0;t<y;t++)for(let u=0;u<g/2;u++){let N=t*g+u,O=t*g+u+g/2,F=M.shift();i[N]=F[0],i[O]=F[1]}}let z;z=w instanceof BigBuffer?new BigBuffer(k*f):new Uint8Array(k*f);let G=0;for(let v=0;v<j;v++)z.set(i[v],G),G+=i[v].byteLength;return z},a.fftJoin=async function(k,r,u,s){let b=3*a.F.n8,l;if("G1"==c)l="g1m_fftJoin";else if("G2"==c)l="g2m_fftJoin";else if("Fr"==c)l="frm_fftJoin";else throw Error("Invalid group");if(k.byteLength!=r.byteLength)throw Error("Invalid buffer size");let f=Math.floor(k.byteLength/b);if(f!=1<<log2(f))throw Error("Invalid number of points");let m=1<<log2(e.concurrency);f<=2*m&&(m=1);let g=f/m,t=[];for(let i=0;i<m;i++){let h=[],v=d.mul(u,d.exp(s,i*g)),w=k.slice(i*g*b,(i+1)*g*b),x=r.slice(i*g*b,(i+1)*g*b);h.push({cmd:"ALLOCSET",var:0,buff:w}),h.push({cmd:"ALLOCSET",var:1,buff:x}),h.push({cmd:"ALLOCSET",var:2,buff:v}),h.push({cmd:"ALLOCSET",var:3,buff:s}),h.push({cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:g},{var:2},{var:3}]}),h.push({cmd:"GET",out:0,var:0,len:g*b}),h.push({cmd:"GET",out:1,var:1,len:g*b}),t.push(e.queueAction(h))}let n=await Promise.all(t),o,p;k instanceof BigBuffer?(o=new BigBuffer(f*b),p=new BigBuffer(f*b)):(o=new Uint8Array(f*b),p=new Uint8Array(f*b));let q=0;for(let j=0;j<n.length;j++)o.set(n[j][0],q),p.set(n[j][1],q),q+=n[j][0].byteLength;return[o,p]},a.fftFinal=async function(j,s){let k=3*a.F.n8,l=2*a.F.n8,m,n;if("G1"==c)m="g1m_fftFinal",n="g1m_batchToAffine";else if("G2"==c)m="g2m_fftFinal",n="g2m_batchToAffine";else throw Error("Invalid group");let b=Math.floor(j.byteLength/k);if(b!=1<<log2(b))throw Error("Invalid number of points");let h=Math.floor(b/e.concurrency),q=[];for(let d=0;d<e.concurrency;d++){let g;if(0==(g=d<e.concurrency-1?h:b-d*h))continue;let f=[],t=j.slice(d*h*k,(d*h+g)*k);f.push({cmd:"ALLOCSET",var:0,buff:t}),f.push({cmd:"ALLOCSET",var:1,buff:s}),f.push({cmd:"CALL",fnName:m,params:[{var:0},{val:g},{var:1},]}),f.push({cmd:"CALL",fnName:n,params:[{var:0},{val:g},{var:0},]}),f.push({cmd:"GET",out:0,var:0,len:g*l}),q.push(e.queueAction(f))}let o=await Promise.all(q),p;p=j instanceof BigBuffer?new BigBuffer(b*l):new Uint8Array(b*l);let r=0;for(let i=o.length-1;i>=0;i--)p.set(o[i][0],r),r+=o[i][0].byteLength;return p}}async function buildEngine(b){let c=await buildThreadManager(b.wasm,b.singleThread),a={};return a.q=e(b.wasm.q.toString()),a.r=e(b.wasm.r.toString()),a.name=b.name,a.tm=c,a.prePSize=b.wasm.prePSize,a.preQSize=b.wasm.preQSize,a.Fr=new WasmField1(c,"frm",b.n8r,b.r),a.F1=new WasmField1(c,"f1m",b.n8q,b.q),a.F2=new WasmField2(c,"f2m",a.F1),a.G1=new WasmCurve(c,"g1m",a.F1,b.wasm.pG1gen,b.wasm.pG1b,b.cofactorG1),a.G2=new WasmCurve(c,"g2m",a.F2,b.wasm.pG2gen,b.wasm.pG2b,b.cofactorG2),a.F6=new WasmField3(c,"f6m",a.F2),a.F12=new WasmField2(c,"ftm",a.F6),a.Gt=a.F12,buildBatchApplyKey(a,"G1"),buildBatchApplyKey(a,"G2"),buildBatchApplyKey(a,"Fr"),buildMultiexp(a,"G1"),buildMultiexp(a,"G2"),buildFFT(a,"G1"),buildFFT(a,"G2"),buildFFT(a,"Fr"),!function(a){let b=a.tm;a.pairing=function(d,f){b.startSyncOp();let g=b.allocBuff(a.G1.toJacobian(d)),h=b.allocBuff(a.G2.toJacobian(f)),c=b.alloc(a.Gt.n8);b.instance.exports[a.name+"_pairing"](g,h,c);let i=b.getBuff(c,a.Gt.n8);return b.endSyncOp(),i},a.pairingEq=async function(){let g,h;arguments.length%2==1?(g=arguments[arguments.length-1],h=(arguments.length-1)/2):(g=a.Gt.one,h=arguments.length/2);let j=[];for(let f=0;f<h;f++){let c=[],l=a.G1.toJacobian(arguments[2*f]);c.push({cmd:"ALLOCSET",var:0,buff:l}),c.push({cmd:"ALLOC",var:1,len:a.prePSize});let m=a.G2.toJacobian(arguments[2*f+1]);c.push({cmd:"ALLOCSET",var:2,buff:m}),c.push({cmd:"ALLOC",var:3,len:a.preQSize}),c.push({cmd:"ALLOC",var:4,len:a.Gt.n8}),c.push({cmd:"CALL",fnName:a.name+"_prepareG1",params:[{var:0},{var:1}]}),c.push({cmd:"CALL",fnName:a.name+"_prepareG2",params:[{var:2},{var:3}]}),c.push({cmd:"CALL",fnName:a.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),c.push({cmd:"GET",out:0,var:4,len:a.Gt.n8}),j.push(b.queueAction(c))}let k=await Promise.all(j);b.startSyncOp();let d=b.alloc(a.Gt.n8);b.instance.exports.ftm_one(d);for(let i=0;i<k.length;i++){let n=b.allocBuff(k[i][0]);b.instance.exports.ftm_mul(d,n,d)}b.instance.exports[a.name+"_finalExponentiation"](d,d);let o=b.allocBuff(g),p=!!b.instance.exports.ftm_eq(d,o);return b.endSyncOp(),p},a.prepareG1=function(b){this.tm.startSyncOp();let c=this.tm.allocBuff(b),a=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](c,a);let d=this.tm.getBuff(a,this.prePSize);return this.tm.endSyncOp(),d},a.prepareG2=function(b){this.tm.startSyncOp();let c=this.tm.allocBuff(b),a=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](c,a);let d=this.tm.getBuff(a,this.preQSize);return this.tm.endSyncOp(),d},a.millerLoop=function(b,c){this.tm.startSyncOp();let d=this.tm.allocBuff(b),f=this.tm.allocBuff(c),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](d,f,a);let g=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),g},a.finalExponentiation=function(b){this.tm.startSyncOp();let c=this.tm.allocBuff(b),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](c,a);let d=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),d}}(a),a.array2buffer=function(b,c){let d=new Uint8Array(c*b.length);for(let a=0;a<b.length;a++)d.set(b[a],a*c);return d},a.buffer2array=function(c,b){let d=c.byteLength/b,f=Array(d);for(let a=0;a<d;a++)f[a]=c.slice(a*b,a*b+b);return f},a}async function buildBn128(c,f){let a=new wasmbuilder.ModuleBuilder;a.setMemory(25),wasmcurves.buildBn128(a),f&&f(a);let b={};if(b.code=a.build(),b.pq=a.modules.f1m.pq,b.pr=a.modules.frm.pq,b.pG1gen=a.modules.bn128.pG1gen,b.pG1zero=a.modules.bn128.pG1zero,b.pG1b=a.modules.bn128.pG1b,b.pG2gen=a.modules.bn128.pG2gen,b.pG2zero=a.modules.bn128.pG2zero,b.pG2b=a.modules.bn128.pG2b,b.pOneT=a.modules.bn128.pOneT,b.prePSize=a.modules.bn128.prePSize,b.preQSize=a.modules.bn128.preQSize,b.n8q=32,b.n8r=32,b.q=a.modules.bn128.q,b.r=a.modules.bn128.r,!c&&globalThis.curve_bn128)return globalThis.curve_bn128;let g={name:"bn128",wasm:b,q:e("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:e("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:e("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!c},d=await buildEngine(g);return d.terminate=async function(){g.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},c||(globalThis.curve_bn128=d),d}async function buildBls12381(c,f){let a=new wasmbuilder.ModuleBuilder;a.setMemory(25),wasmcurves.buildBls12381(a),f&&f(a);let b={};if(b.code=a.build(),b.pq=a.modules.f1m.pq,b.pr=a.modules.frm.pq,b.pG1gen=a.modules.bls12381.pG1gen,b.pG1zero=a.modules.bls12381.pG1zero,b.pG1b=a.modules.bls12381.pG1b,b.pG2gen=a.modules.bls12381.pG2gen,b.pG2zero=a.modules.bls12381.pG2zero,b.pG2b=a.modules.bls12381.pG2b,b.pOneT=a.modules.bls12381.pOneT,b.prePSize=a.modules.bls12381.prePSize,b.preQSize=a.modules.bls12381.preQSize,b.n8q=48,b.n8r=32,b.q=a.modules.bls12381.q,b.r=a.modules.bls12381.r,!c&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let g={name:"bls12381",wasm:b,q:e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:e("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:e("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!c},d=await buildEngine(g);return d.terminate=async function(){g.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},c||(globalThis.curve_bls12381=d),d}globalThis.curve_bn128=null,globalThis.curve_bls12381=null;let bls12381r=e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),bn128r=e("21888242871839275222246405745257275088548364400416034343698204186575808495617"),bls12381q=e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),bn128q=e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function getCurveFromR(a,c,d){let b;if(eq(a,bn128r))b=await buildBn128(c,d);else if(eq(a,bls12381r))b=await buildBls12381(c,d);else throw Error(`Curve not supported: ${toString(a)}`);return b}async function getCurveFromQ(a,c,d){let b;if(eq(a,bn128q))b=await buildBn128(c,d);else if(eq(a,bls12381q))b=await buildBls12381(c,d);else throw Error(`Curve not supported: ${toString(a,16)}`);return b}async function getCurveFromName(b,c,d){var e;let a,f=(e=b,e.toUpperCase().match(/[A-Za-z0-9]+/g).join(""));if(["BN128","BN254","ALTBN128"].indexOf(f)>=0)a=await buildBn128(c,d);else if(["BLS12381"].indexOf(f)>=0)a=await buildBls12381(c,d);else throw Error(`Curve not supported: ${b}`);return a}exports.BigBuffer=BigBuffer,exports.ChaCha=ChaCha,exports.EC=class{constructor(a,b){this.F=a,this.g=b,2==this.g.length&&(this.g[2]=this.F.one),this.zero=[this.F.zero,this.F.one,this.F.zero]}add(b,c){let a=this.F;if(this.eq(b,this.zero))return c;if(this.eq(c,this.zero))return b;let d=[,,],f=a.square(b[2]),g=a.square(c[2]),h=a.mul(b[0],g),k=a.mul(c[0],f),r=a.mul(b[2],f),s=a.mul(c[2],g),i=a.mul(b[1],s),l=a.mul(c[1],r);if(a.eq(h,k)&&a.eq(i,l))return this.double(b);let e=a.sub(k,h),m=a.sub(l,i),n=a.square(a.add(e,e)),o=a.mul(e,n),p=a.add(m,m),j=a.mul(h,n);d[0]=a.sub(a.sub(a.square(p),o),a.add(j,j));let q=a.mul(i,o);return d[1]=a.sub(a.mul(p,a.sub(j,d[0])),a.add(q,q)),d[2]=a.mul(e,a.sub(a.square(a.add(b[2],c[2])),a.add(f,g))),d}neg(a){return[a[0],this.F.neg(a[1]),a[2]]}sub(a,b){return this.add(a,this.neg(b))}double(b){let a=this.F,e=[,,];if(this.eq(b,this.zero))return b;let f=a.square(b[0]),h=a.square(b[1]),g=a.square(h),d=a.sub(a.square(a.add(b[0],h)),a.add(f,g));d=a.add(d,d);let i=a.add(a.add(f,f),f),k=a.square(i);e[0]=a.sub(k,a.add(d,d));let c=a.add(g,g);c=a.add(c,c),c=a.add(c,c),e[1]=a.sub(a.mul(i,a.sub(d,e[0])),c);let j=a.mul(b[1],b[2]);return e[2]=a.add(j,j),e}timesScalar(a,b){return mulScalar(this,a,b)}mulScalar(a,b){return mulScalar(this,a,b)}affine(b){let a=this.F;if(this.isZero(b))return this.zero;if(a.eq(b[2],a.one))return b;{let d=a.inv(b[2]),e=a.square(d),f=a.mul(e,d),c=[,,];return c[0]=a.mul(b[0],e),c[1]=a.mul(b[1],f),c[2]=a.one,c}}multiAffine(e){let b=Object.keys(e),c=this.F,d=Array(b.length+1);d[0]=c.one;for(let f=0;f<b.length;f++)c.eq(e[b[f]][2],c.zero)?d[f+1]=d[f]:d[f+1]=c.mul(d[f],e[b[f]][2]);d[b.length]=c.inv(d[b.length]);for(let a=b.length-1;a>=0;a--)if(c.eq(e[b[a]][2],c.zero))d[a]=d[a+1],e[b[a]]=this.zero;else{let g=c.mul(d[a],d[a+1]);d[a]=c.mul(e[b[a]][2],d[a+1]);let h=c.square(g),i=c.mul(h,g);e[b[a]][0]=c.mul(e[b[a]][0],h),e[b[a]][1]=c.mul(e[b[a]][1],i),e[b[a]][2]=c.one}}eq(c,b){let a=this.F;if(this.F.eq(c[2],this.F.zero))return this.F.eq(b[2],this.F.zero);if(this.F.eq(b[2],this.F.zero))return!1;let d=a.square(c[2]),e=a.square(b[2]),f=a.mul(c[0],e),g=a.mul(b[0],d),h=a.mul(c[2],d),i=a.mul(b[2],e),j=a.mul(c[1],i),k=a.mul(b[1],h);return a.eq(f,g)&&a.eq(j,k)}isZero(a){return this.F.isZero(a[2])}toString(b){let a=this.affine(b);return`[ ${this.F.toString(a[0])} , ${this.F.toString(a[1])} ]`}fromRng(c){let b=this.F,a=[],d;do{a[0]=b.fromRng(c),d=c.nextBool();let e=b.add(b.mul(b.square(a[0]),a[0]),this.b);a[1]=b.sqrt(e)}while(null==a[1]||b.isZero[a])let f=isGreatest(b,a[1]);return d^f&&(a[1]=b.neg(a[1])),a[2]=b.one,this.cofactor&&(a=this.mulScalar(a,this.cofactor)),a=this.affine(a)}toRprLE(b,c,a){if(a=this.affine(a),this.isZero(a)){let d=new Uint8Array(b,c,2*this.F.n8);d.fill(0);return}this.F.toRprLE(b,c,a[0]),this.F.toRprLE(b,c+this.F.n8,a[1])}toRprBE(b,c,a){if(a=this.affine(a),this.isZero(a)){let d=new Uint8Array(b,c,2*this.F.n8);d.fill(0);return}this.F.toRprBE(b,c,a[0]),this.F.toRprBE(b,c+this.F.n8,a[1])}toRprLEM(b,c,a){if(a=this.affine(a),this.isZero(a)){let d=new Uint8Array(b,c,2*this.F.n8);d.fill(0);return}this.F.toRprLEM(b,c,a[0]),this.F.toRprLEM(b,c+this.F.n8,a[1])}toRprLEJM(b,c,a){if(a=this.affine(a),this.isZero(a)){let d=new Uint8Array(b,c,2*this.F.n8);d.fill(0);return}this.F.toRprLEM(b,c,a[0]),this.F.toRprLEM(b,c+this.F.n8,a[1]),this.F.toRprLEM(b,c+2*this.F.n8,a[2])}toRprBEM(b,c,a){if(a=this.affine(a),this.isZero(a)){let d=new Uint8Array(b,c,2*this.F.n8);d.fill(0);return}this.F.toRprBEM(b,c,a[0]),this.F.toRprBEM(b,c+this.F.n8,a[1])}fromRprLE(b,a){a=a||0;let c=this.F.fromRprLE(b,a),d=this.F.fromRprLE(b,a+this.F.n8);return this.F.isZero(c)&&this.F.isZero(d)?this.zero:[c,d,this.F.one]}fromRprBE(b,a){a=a||0;let c=this.F.fromRprBE(b,a),d=this.F.fromRprBE(b,a+this.F.n8);return this.F.isZero(c)&&this.F.isZero(d)?this.zero:[c,d,this.F.one]}fromRprLEM(b,a){a=a||0;let c=this.F.fromRprLEM(b,a),d=this.F.fromRprLEM(b,a+this.F.n8);return this.F.isZero(c)&&this.F.isZero(d)?this.zero:[c,d,this.F.one]}fromRprLEJM(b,a){a=a||0;let c=this.F.fromRprLEM(b,a),d=this.F.fromRprLEM(b,a+this.F.n8),e=this.F.fromRprLEM(b,a+2*this.F.n8);return this.F.isZero(c)&&this.F.isZero(d)?this.zero:[c,d,e]}fromRprBEM(b,a){a=a||0;let c=this.F.fromRprBEM(b,a),d=this.F.fromRprBEM(b,a+this.F.n8);return this.F.isZero(c)&&this.F.isZero(d)?this.zero:[c,d,this.F.one]}fromRprCompressed(d,e){let b=this.F,c=new Uint8Array(d.buffer,e,b.n8);if(64&c[0])return this.zero;let a=[,,],f=(128&c[0])!=0;c[0]=127&c[0],a[0]=b.fromRprBE(d,e),f&&(c[0]=128|c[0]);let g=b.add(b.mul(b.square(a[0]),a[0]),this.b);if(a[1]=b.sqrt(g),null===a[1])throw Error("Invalid Point!");let h=isGreatest(b,a[1]);return f^h&&(a[1]=b.neg(a[1])),a[2]=b.one,a}toRprCompressed(c,d,a){a=this.affine(a);let b=new Uint8Array(c.buffer,d,this.F.n8);if(this.isZero(a)){b.fill(0),b[0]=64;return}this.F.toRprBE(c,d,a[0]),isGreatest(this.F,a[1])&&(b[0]=128|b[0])}fromRprUncompressed(a,b){return 64&a[0]?this.zero:this.fromRprBE(a,b)}toRprUncompressed(a,b,c){this.toRprBE(a,b,c),this.isZero(c)&&(a[b]=64|a[b])}},exports.F1Field=F1Field,exports.F2Field=class{constructor(a,b){this.type="F2",this.F=a,this.zero=[this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=b,this.m=2*a.m,this.p=a.p,this.n64=2*a.n64,this.n32=2*this.n64,this.n8=8*this.n64,buildSqrt(this)}_mulByNonResidue(a){return this.F.mul(this.nonResidue,a)}copy(a){return[this.F.copy(a[0]),this.F.copy(a[1])]}add(a,b){return[this.F.add(a[0],b[0]),this.F.add(a[1],b[1])]}double(a){return this.add(a,a)}sub(a,b){return[this.F.sub(a[0],b[0]),this.F.sub(a[1],b[1])]}neg(a){return this.sub(this.zero,a)}conjugate(a){return[a[0],this.F.neg(a[1])]}mul(a,b){let c=this.F.mul(a[0],b[0]),d=this.F.mul(a[1],b[1]);return[this.F.add(c,this._mulByNonResidue(d)),this.F.sub(this.F.mul(this.F.add(a[0],a[1]),this.F.add(b[0],b[1])),this.F.add(c,d))]}inv(a){let c=this.F.square(a[0]),d=this.F.square(a[1]),e=this.F.sub(c,this._mulByNonResidue(d)),b=this.F.inv(e);return[this.F.mul(a[0],b),this.F.neg(this.F.mul(a[1],b))]}div(a,b){return this.mul(a,this.inv(b))}square(a){let b=this.F.mul(a[0],a[1]);return[this.F.sub(this.F.mul(this.F.add(a[0],a[1]),this.F.add(a[0],this._mulByNonResidue(a[1]))),this.F.add(b,this._mulByNonResidue(b))),this.F.add(b,b)]}isZero(a){return this.F.isZero(a[0])&&this.F.isZero(a[1])}eq(a,b){return this.F.eq(a[0],b[0])&&this.F.eq(a[1],b[1])}mulScalar(a,b){return mulScalar(this,a,b)}pow(a,b){return exp(this,a,b)}exp(a,b){return exp(this,a,b)}toString(a){return`[ ${this.F.toString(a[0])} , ${this.F.toString(a[1])} ]`}fromRng(a){let b=this.F.fromRng(a),c=this.F.fromRng(a);return[b,c]}gt(a,b){return!!this.F.gt(a[0],b[0])|| !this.F.gt(b[0],a[0])&&!!this.F.gt(a[1],b[1])}geq(a,b){return this.gt(a,b)||this.eq(a,b)}lt(a,b){return!this.geq(a,b)}leq(a,b){return!this.gt(a,b)}neq(a,b){return!this.eq(a,b)}random(){return[this.F.random(),this.F.random()]}toRprLE(a,b,c){this.F.toRprLE(a,b,c[0]),this.F.toRprLE(a,b+this.F.n8,c[1])}toRprBE(a,b,c){this.F.toRprBE(a,b,c[1]),this.F.toRprBE(a,b+this.F.n8,c[0])}toRprLEM(a,b,c){this.F.toRprLEM(a,b,c[0]),this.F.toRprLEM(a,b+this.F.n8,c[1])}toRprBEM(a,b,c){this.F.toRprBEM(a,b,c[1]),this.F.toRprBEM(a,b+this.F.n8,c[0])}fromRprLE(b,a){a=a||0;let c=this.F.fromRprLE(b,a),d=this.F.fromRprLE(b,a+this.F.n8);return[c,d]}fromRprBE(b,a){a=a||0;let c=this.F.fromRprBE(b,a),d=this.F.fromRprBE(b,a+this.F.n8);return[d,c]}fromRprLEM(b,a){a=a||0;let c=this.F.fromRprLEM(b,a),d=this.F.fromRprLEM(b,a+this.F.n8);return[c,d]}fromRprBEM(b,a){a=a||0;let c=this.F.fromRprBEM(b,a),d=this.F.fromRprBEM(b,a+this.F.n8);return[d,c]}toObject(a){return a}},exports.F3Field=class{constructor(a,b){this.type="F3",this.F=a,this.zero=[this.F.zero,this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=b,this.m=3*a.m,this.p=a.p,this.n64=3*a.n64,this.n32=2*this.n64,this.n8=8*this.n64}_mulByNonResidue(a){return this.F.mul(this.nonResidue,a)}copy(a){return[this.F.copy(a[0]),this.F.copy(a[1]),this.F.copy(a[2])]}add(a,b){return[this.F.add(a[0],b[0]),this.F.add(a[1],b[1]),this.F.add(a[2],b[2])]}double(a){return this.add(a,a)}sub(a,b){return[this.F.sub(a[0],b[0]),this.F.sub(a[1],b[1]),this.F.sub(a[2],b[2])]}neg(a){return this.sub(this.zero,a)}mul(a,b){let c=this.F.mul(a[0],b[0]),d=this.F.mul(a[1],b[1]),e=this.F.mul(a[2],b[2]);return[this.F.add(c,this._mulByNonResidue(this.F.sub(this.F.mul(this.F.add(a[1],a[2]),this.F.add(b[1],b[2])),this.F.add(d,e)))),this.F.add(this.F.sub(this.F.mul(this.F.add(a[0],a[1]),this.F.add(b[0],b[1])),this.F.add(c,d)),this._mulByNonResidue(e)),this.F.add(this.F.sub(this.F.mul(this.F.add(a[0],a[2]),this.F.add(b[0],b[2])),this.F.add(c,e)),d)]}inv(a){let f=this.F.square(a[0]),g=this.F.square(a[1]),h=this.F.square(a[2]),i=this.F.mul(a[0],a[1]),j=this.F.mul(a[0],a[2]),k=this.F.mul(a[1],a[2]),c=this.F.sub(f,this._mulByNonResidue(k)),d=this.F.sub(this._mulByNonResidue(h),i),e=this.F.sub(g,j),b=this.F.inv(this.F.add(this.F.mul(a[0],c),this._mulByNonResidue(this.F.add(this.F.mul(a[2],d),this.F.mul(a[1],e)))));return[this.F.mul(b,c),this.F.mul(b,d),this.F.mul(b,e)]}div(a,b){return this.mul(a,this.inv(b))}square(a){let b=this.F.square(a[0]),c=this.F.mul(a[0],a[1]),d=this.F.add(c,c),h=this.F.square(this.F.add(this.F.sub(a[0],a[1]),a[2])),e=this.F.mul(a[1],a[2]),f=this.F.add(e,e),g=this.F.square(a[2]);return[this.F.add(b,this._mulByNonResidue(f)),this.F.add(d,this._mulByNonResidue(g)),this.F.sub(this.F.add(this.F.add(d,h),f),this.F.add(b,g))]}isZero(a){return this.F.isZero(a[0])&&this.F.isZero(a[1])&&this.F.isZero(a[2])}eq(a,b){return this.F.eq(a[0],b[0])&&this.F.eq(a[1],b[1])&&this.F.eq(a[2],b[2])}affine(a){return[this.F.affine(a[0]),this.F.affine(a[1]),this.F.affine(a[2])]}mulScalar(a,b){return mulScalar(this,a,b)}pow(a,b){return exp(this,a,b)}exp(a,b){return exp(this,a,b)}toString(a){return`[ ${this.F.toString(a[0])} , ${this.F.toString(a[1])}, ${this.F.toString(a[2])} ]`}fromRng(a){let b=this.F.fromRng(a),c=this.F.fromRng(a),d=this.F.fromRng(a);return[b,c,d]}gt(a,b){return!!this.F.gt(a[0],b[0])|| !this.F.gt(b[0],a[0])&&(!!this.F.gt(a[1],b[1])|| !this.F.gt(b[1],a[1])&&!!this.F.gt(a[2],b[2]))}geq(a,b){return this.gt(a,b)||this.eq(a,b)}lt(a,b){return!this.geq(a,b)}leq(a,b){return!this.gt(a,b)}neq(a,b){return!this.eq(a,b)}random(){return[this.F.random(),this.F.random(),this.F.random()]}toRprLE(a,b,c){this.F.toRprLE(a,b,c[0]),this.F.toRprLE(a,b+this.F.n8,c[1]),this.F.toRprLE(a,b+2*this.F.n8,c[2])}toRprBE(a,b,c){this.F.toRprBE(a,b,c[2]),this.F.toRprBE(a,b+this.F.n8,c[1]),this.F.toRprBE(a,b+2*this.F.n8,c[0])}toRprLEM(a,b,c){this.F.toRprLEM(a,b,c[0]),this.F.toRprLEM(a,b+this.F.n8,c[1]),this.F.toRprLEM(a,b+2*this.F.n8,c[2])}toRprBEM(a,b,c){this.F.toRprBEM(a,b,c[2]),this.F.toRprBEM(a,b+this.F.n8,c[1]),this.F.toRprBEM(a,b+2*this.F.n8,c[0])}fromRprLE(b,a){a=a||0;let c=this.F.fromRprLE(b,a),d=this.F.fromRprLE(b,a+this.n8),e=this.F.fromRprLE(b,a+2*this.n8);return[c,d,e]}fromRprBE(b,a){a=a||0;let c=this.F.fromRprBE(b,a),d=this.F.fromRprBE(b,a+this.n8),e=this.F.fromRprBE(b,a+2*this.n8);return[e,d,c]}fromRprLEM(b,a){a=a||0;let c=this.F.fromRprLEM(b,a),d=this.F.fromRprLEM(b,a+this.n8),e=this.F.fromRprLEM(b,a+2*this.n8);return[c,d,e]}fromRprBEM(b,a){a=a||0;let c=this.F.fromRprBEM(b,a),d=this.F.fromRprBEM(b,a+this.n8),e=this.F.fromRprBEM(b,a+2*this.n8);return[e,d,c]}toObject(a){return a}},exports.PolField=class PolField{constructor(c){this.F=c;let d=c.sqrt_t,a=c.sqrt_s,e=this.F.add(this.F.add(this.F.two,this.F.two),this.F.one);this.w=Array(a+1),this.wi=Array(a+1),this.w[a]=this.F.pow(e,d),this.wi[a]=this.F.inv(this.w[a]);let b=a-1;for(;b>=0;)this.w[b]=this.F.square(this.w[b+1]),this.wi[b]=this.F.square(this.wi[b+1]),b--;this.roots=[],this._setRoots(15)}_setRoots(b){b>this.F.sqrt_s&&(b=this.s);for(let a=b;a>=0&&!this.roots[a];a--){let c=this.F.one,e=1<<a,f=Array(e);for(let d=0;d<e;d++)f[d]=c,c=this.F.mul(c,this.w[a]);this.roots[a]=f}}add(b,c){let d=Math.max(b.length,c.length),e=Array(d);for(let a=0;a<d;a++)e[a]=this.F.add(b[a]||this.F.zero,c[a]||this.F.zero);return this.reduce(e)}double(a){return this.add(a,a)}sub(b,c){let d=Math.max(b.length,c.length),e=Array(d);for(let a=0;a<d;a++)e[a]=this.F.sub(b[a]||this.F.zero,c[a]||this.F.zero);return this.reduce(e)}mulScalar(a,c){if(this.F.eq(c,this.F.zero))return[];if(this.F.eq(c,this.F.one))return a;let d=Array(a.length);for(let b=0;b<a.length;b++)d[b]=this.F.mul(a[b],c);return d}mul(b,a){return 0==b.length||0==a.length?[]:1==b.length?this.mulScalar(a,b[0]):1==a.length?this.mulScalar(b,a[0]):(a.length>b.length&&([a,b]=[b,a]),a.length<=2||a.length<log2$2(b.length))?this.mulNormal(b,a):this.mulFFT(b,a)}mulNormal(d,c){let b=[];for(let a=0;a<c.length;a++)b=this.add(b,this.scaleX(this.mulScalar(d,c[a]),a));return b}mulFFT(e,f){let i=Math.max(e.length,f.length),b=log2$2(i-1)+2;this._setRoots(b);let a=1<<b,j=this.extend(e,a),k=this.extend(f,a),l=__fft$1(this,j,b,0,1),m=__fft$1(this,k,b,0,1),g=Array(a);for(let c=0;c<a;c++)g[c]=this.F.mul(l[c],m[c]);let n=__fft$1(this,g,b,0,1),o=this.F.inv(this.F.mulScalar(this.F.one,a)),h=Array(a);for(let d=0;d<a;d++)h[d]=this.F.mul(n[(a-d)%a],o);return this.reduce(h)}square(a){return this.mul(a,a)}scaleX(b,a){if(0==a)return b;if(a>0){let c=Array(a).fill(this.F.zero);return c.concat(b)}return-a>=b.length?[]:b.slice(-a)}eval2(d,e){let a=this.F.zero,b=this.F.one;for(let c=0;c<d.length;c++)a=this.F.add(a,this.F.mul(d[c],b)),b=this.F.mul(b,e);return a}eval(p,x){let F=this.F;if(0==p.length)return F.zero;let m=this._next2Power(p.length),ep=this.extend(p,m);return _eval(ep,x,0,1,m);function _eval(a,e,b,c,d){if(1==d)return a[b];let f=F.square(e),g=F.add(_eval(a,f,b,c<<1,d>>1),F.mul(e,_eval(a,f,b+c,c<<1,d>>1)));return g}}lagrange(a){let d=[this.F.one];for(let e=0;e<a.length;e++)d=this.mul(d,[this.F.neg(a[e][0]),this.F.one]);let f=[];for(let b=0;b<a.length;b++){let c=this.ruffini(d,a[b][0]),g=this.F.mul(this.F.inv(this.eval(c,a[b][0])),a[b][1]);c=this.mulScalar(c,g),f=this.add(f,c)}return f}fft(a){if(a.length<=1)return a;let b=log2$2(a.length-1)+1;this._setRoots(b);let c=1<<b,d=this.extend(a,c),e=__fft$1(this,d,b,0,1);return e}fft2(a){if(a.length<=1)return a;let b=log2$2(a.length-1)+1;this._setRoots(b);let d=1<<b,c=this.extend(a,d);__bitReverse(c,b);let e=__fft2(this,c,b);return e}ifft(b){if(b.length<=1)return b;let d=log2$2(b.length-1)+1;this._setRoots(d);let a=1<<d,f=this.extend(b,a),g=__fft$1(this,f,d,0,1),h=this.F.inv(this.F.mulScalar(this.F.one,a)),e=Array(a);for(let c=0;c<a;c++)e[c]=this.F.mul(g[(a-c)%a],h);return e}ifft2(b){if(b.length<=1)return b;let c=log2$2(b.length-1)+1;this._setRoots(c);let a=1<<c,e=this.extend(b,a);__bitReverse(e,c);let g=__fft2(this,e,c),h=this.F.inv(this.F.mulScalar(this.F.one,a)),f=Array(a);for(let d=0;d<a;d++)f[d]=this.F.mul(g[(a-d)%a],h);return f}_fft(d,b,e,f){let g=1<<b;if(1==g)return[d[e]];let i=g>>1,j=this._fft(d,b-1,e,2*f),k=this._fft(d,b-1,e+f,2*f),h=Array(g),c=this.F.one;for(let a=0;a<i;a++)h[a]=this.F.add(j[a],this.F.mul(c,k[a])),h[a+i]=this.F.sub(j[a],this.F.mul(c,k[a])),c=this.F.mul(c,this.w[b]);return h}extend(a,b){if(b==a.length)return a;let c=Array(b-a.length).fill(this.F.zero);return a.concat(c)}reduce(a){if(0==a.length||!this.F.eq(a[a.length-1],this.F.zero))return a;let b=a.length-1;for(;b>0&&this.F.eq(a[b],this.F.zero);)b--;return a.slice(0,b+1)}eq(d,e){let c=this.reduce(d),b=this.reduce(e);if(c.length!=b.length)return!1;for(let a=0;a<b.length;a++)if(!this.F.eq(c[a],b[a]))return!1;return!0}ruffini(c,d){let a=Array(c.length-1);a[a.length-1]=c[c.length-1];for(let b=a.length-2;b>=0;b--)a[b]=this.F.add(this.F.mul(a[b+1],d),c[b+1]);return a}_next2Power(a){return a--,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,++a}toString(c){let d=this.normalize(c),a="";for(let b=d.length-1;b>=0;b--)!this.F.eq(c[b],this.F.zero)&&(""!=a&&(a+=" + "),a+=c[b].toString(10),b>0&&(a+="x",b>1&&(a=a+"^"+b)));return a}normalize(b){let c=Array(b.length);for(let a=0;a<b.length;a++)c[a]=this.F.normalize(b[a]);return c}_reciprocal(b,c){let a=1<<c;if(1==a)return[this.F.inv(b[0])];let e=this.scaleX(b,-a/2),d=this._reciprocal(e,c-1),f=this.scaleX(this.double(d),3*a/2-2),g=this.mul(this.square(d),b);return this.scaleX(this.sub(f,g),-(a-2))}_div2(e,a){let b=log2$2(a.length-1)+1,c=1<<b,d=c-a.length,f=this._reciprocal(this.scaleX(a,d),b),g=this.scaleX(f,e-2*c+2+d);return g}div(g,a){if(g.length<a.length)return[];let h=log2$2(a.length-1)+1,i=1<<h,j=this.scaleX(g,i-a.length),c=this.scaleX(a,i-a.length),b=c.length-1,d=j.length-1,k=this._reciprocal(c,h),l;d>2*b&&(l=this.sub(this.scaleX([this.F.one],2*b),this.mul(k,c)));let e=[],f=j,m,n,o=!1;for(;!o;)m=this.mul(f,k),e=this.add(e,this.scaleX(m,-2*b)),d>2*b?(n=this.mul(f,l),d=(f=this.scaleX(n,-2*b)).length-1):o=!0;return e}oneRoot(a,e){let b=log2$2(a-1)+1,c=this.F.one,d=e;if(e>=a)throw Error("Given 'i' should be lower than 'n'");if(1<<b!==a)throw Error(`Internal errlr: ${a} should equal ${1<<b}`);for(;d>0;)!0&d&&(c=this.F.mul(c,this.w[b])),d>>=1,b--;return c}computeVanishingPolinomial(a,b){return this.F.sub(this.F.pow(b,1<<a),this.F.one)}evaluateLagrangePolynomials(a,e){let b=1<<a,h=this.F.pow(e,b),c=Array(b).fill(this.F.zero);this._setRoots(a);let i=this.w[a];if(this.F.eq(h,this.F.one)){for(let f=0;f<b;f++)if(this.F.eq(this.roots[a][0],e))return c[f]=this.F.one,c}let j=this.F.sub(h,this.F.one),g=this.F.mul(j,this.F.inv(this.F.e(b)));for(let d=0;d<b;d++)c[d]=this.F.mul(g,this.F.inv(this.F.sub(e,this.roots[a][d]))),g=this.F.mul(g,i);return c}log2(a){return log2$2(a)}},exports.Scalar=_Scalar,exports.ZqField=F1Field,exports.buildBls12381=buildBls12381,exports.buildBn128=buildBn128,exports.getCurveFromName=getCurveFromName,exports.getCurveFromQ=getCurveFromQ,exports.getCurveFromR=getCurveFromR,exports.utils=_utils}}])